!function(){var E,N,P,n,s,i,c,d,T,o,_,p,u,m,l,r,g,L,A,w,O;E=document.location.protocol.toString(),N=document.location.hostname.toString(),P=222,n=window.Device||unsafeWindow.Device,A={comments:!(L="spaces-dev.github.io"),blogsd:!(g=1),readersd:!(u=-1),favorite:!(r=l=m=p=_=o=T=0),rotate:!(d=c=i=s=null),playback:!0,blocked:!0,rscroll:!1,hrightbar:!1,apidebug:!1,playerdn:!0,nredirect:!0,coins:!0,karma:!0,online:!0,ads:!0,myEvents:!1,friendsOn:!0,sticker:!0,fixes:!0,bodystyle:!0,upVersion:P,bodystyleSetting:{url:"https://"+L+"/src/backgrounds/default.jpg",color:"#DAE1E8",urlchecked:!0,colorchecked:!1},events:{url:"https://"+L+"/src/sounds/default.ogg",volume:70,mail:!0,journal:!0,feed:!1,notifications:!1},friendsOnMax:10,friendsListSH:!0,friendsDisplay:!0,hideNotyf:{cookieEditor:!1,configImport:!1},msgAlert:!1,msgAlertSettings:{alertPosition:4,maxAlert:3,animDelay:3,alertDelay:3}},w={comments:"Пакетное удаление комментариев",blogsd:"Пакетное удаление блогов",readersd:"Пакетное удаление читателей",friendsOn:"Панель друзей онлайн",myEvents:"Звук уведомлений",online:"Точное время онлайн в анкетах",ads:"Скрывать рекламу",favorite:"Возможность добавить пользователя в закладки",rotate:"Кнопка поворота фото/видео в просмотрщике",playback:"Кнопка ускорения видео",playerdn:"Кнопка загрузки трека из плеера",nredirect:"Внешние ссылки без редиректа",rscroll:"Прокрутка страницы справа",hrightbar:"Скрыть правое меню",blocked:"Открытые разделы удаленных пользователей",coins:"Собирать бонусные монеты",karma:"Собирать карму",bodystyle:"Фон сайта",msgAlert:"Виджет почты",sticker:"Бесплатные стикеры",fixes:"Незначительные исправления"},(O={ajax:function(e,t,a,s,n,i){n=void 0!==n?n:4;var l=new XMLHttpRequest;l.open(t,e,!0),i&&l.setRequestHeader("X-Proxy","spaces"),"POST"==t?(l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(a)):l.send(),l.onreadystatechange=function(){if(l.readyState==n){if(200!=l.status)return!1;s&&s(l.responseText)}}},jajax:function(e,t){e=e.replace(/\#.*$/i,"")+(1<=e.indexOf("?")?"&json=1":"?json=1");var a=new XMLHttpRequest;a.open("GET",e,!0),a.setRequestHeader("X-Proxy","spaces"),a.send(null),a.onreadystatechange=function(){return 4!=a.readyState||200!=a.status?null:void(t&&t(a.responseText))}},getQuery:function(a){var e=document.location.search,s=null;try{return a=a.toLowerCase(),1<=e.toLowerCase().indexOf(a)&&e.substring(1).split("&").forEach(function(e){var t=e.split("=");t[0].toLowerCase()==a&&(s=t[1])}),s}catch(e){return O.console.error("Ошибка (GETQUERY): "+e.name+":"+e.message+"\n"+e.stack),null}},getPath:function(e){var t,a=document.location.pathname.toString();try{var s=a.replace(/\/\s*$/,"").split("/");switch(e){case"method":t=s[1];break;case"index":t=s[2];break;case"target":t=s[3]}return t}catch(e){return O.console.error("Ошибка (GETPATH): "+e.name+":"+e.message+"\n"+e.stack),null}},getParams:function(e){var t={},a=document.createElement("a");a.href=e;for(var s=a.search.substring(1).split("&"),n=0;n<s.length;n++){var i=s[n].split("=");t[i[0]]=decodeURIComponent(i[1])}return t},css:function(e,t){var a=t.split(";");for(var s in a)if(""!=O.trim(a[s])){var n=O.trim(a[s]).split(":");0<=n[0].indexOf("-")&&(n[0]=n[0].replace(/\-([a-z]{1})/g,function(e,t){return t.toUpperCase()})),void 0!==n[1]&&(e.style[O.trim(n[0])]=O.trim(n[1]))}},htmlspecialchars:function(e){return"string"==typeof e&&(e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("\n","br/>")),e},rever:function(e){return e?e.toString().split("").join("."):e},ce:function(e,t){var a=document.createElement(e);if(t)for(var s in t)if("style"==s)O.css(a,t[s]);else if("attr"==s)for(var n in t[s])a.setAttribute(n,t[s][n]);else"html"==s?a.innerHTML=t[s]:"class"==s?a.className=t[s]:a[s]=t[s];return a},readSettings:function(){var e=O.getCookie("SP_PLUS_SET");try{e&&(e=JSON.parse(e),A=O.extend(A,e))}catch(e){O.console.error("Ошибка (READSETTINGS): "+e.name+":"+e.message+"\n"+e.stack)}},newbequest:function(){var t=O.qs("#sp_newbequest_togl");t&&O.jajax(E+"//"+N+"/mysite/",function(e){try{if(e){O.extend({owner_widget:{newbee_quest_widget:null}},JSON.parse(e)).owner_widget.newbee_quest_widget?t.style.display="":t.style.display="none"}}catch(e){O.console.error("Ошибка (NEWBEE-JSON): "+e.name+":"+e.message+"\n"+e.stack)}})},settings:function(){var e=document.location.pathname.toString(),S=document.location.href.toString();if("/settings/"==e&&!O.qs("#SP_PLUS_SETLINK"))try{var t=O.find(document.links,{href:E+"//"+N+"/settings/notification/?"});if(t){t=t[0];var y=O.getQuery("sp_plus_settings"),k=O.getQuery("sp_cookie_editor"),C=O.getQuery("sp_changelog"),x=O.getQuery("sp_backup"),a=O.ce("a",{href:E+"//"+N+"/settings/?sp_plus_settings=1",id:"SP_PLUS_SETLINK",class:t.className,html:'<span>Настройки Spaces+</span><span class="ico ico_arr ico_m"></span>',onclick:function(){var e=O.qs("#SP_PLUS_SETLINK").parentNode.parentNode.parentNode.parentNode;if("main"==e.id){var t=O.qs("#header_path");t&&(t.innerHTML=t.innerHTML.replace("Настройки",'<a href="'+E+"//"+N+'/settings/" style="margin-bottom: 1px;">Настройки</a><span class="location-bar__sep ico"></span><span id="SP_PLUS_SETHEAD2">Spaces+</span>')),e.innerHTML='<div class="widgets-group widgets-group_top js-container__block"><div class="b-title cl b-title_center b-title_first oh"><div class="b-title__item" id="SP_PLUS_SETHEAD">Настройки Spaces+</div></div><div class="content"><div class="list f-c_fll"> <div id="SP_PLUS_SETAREA"></div></div></div></div> <div id="SP_PLUS_ABOUT"></div> <a id="SP_PLUS_SETBACK" href="http://'+N+'/settings/?" class="link-return full_link"><span class="ico ico_arrow-back" style="margin: 0px 6px -1px 0px;"></span><span class="m">Назад</span></a>'}var a=O.qs("#SP_PLUS_SETAREA");if(a){for(var s in A){if(void 0!==w[s])var r=O.qs("#SP_PLUS_ALERT"),n=O.ce("input",{id:"sp_set_"+s,type:"checkbox",class:"sp-checkbox-square",checked:A[s],onclick:function(e){var t=e.target.id.split("_")[2];A[t]=e.target.checked;var a=JSON.stringify(A);if(O.setCookie("SP_PLUS_SET",a,null),"sp_set_rscroll"==e.target.id)O.scrollMove(e.target.checked);else if("sp_set_hrightbar"==e.target.id)O.hiddenRightbar(e.target.checked);else if("sp_set_bodystyle"==e.target.id)if(e.target.checked)O.bgSettings(e.target);else{var s=O.qs("#SP_PLUS_BODYSTYLE");s&&O.remove(s)}else if("sp_set_myEvents"==e.target.id)if(e.target.checked)O.evenstSupport(e.target),O.alert("Звук уведомлений<div class='pad_t_a'></div><small class='pad_t_a grey'>В настройках сайта должен быть звук уведомлений <p style='color: #f86934;display: inline;font-weight: bold;'>выключен</p>. Разрешены аудиофайлы в форматах <b>.ogg</b>, <b>.mp3</b> или <b>.wav</b> Указывайте прямую ссылку на аудиофайл!<div class='pad_t_a'></small>Список фонов и звуков: <a href='https://"+L+"' target='_blank'>https://"+L+"</a></div>",1,1);else{T=0;var n=O.qs("#SP_PLUS_EVENTS");r&&O.remove(r),n&&O.remove(n)}else if("sp_set_friendsOn"==e.target.id)if(O.friendsOnline(e.target.checked),e.target.checked)O.setFriend(e.target);else{var i=O.qs("#SP_PLUS_MAXFRIENDS");i&&O.remove(i)}else if("sp_set_comments"==e.target.id)O.commentsDelete(e.target.checked);else if("sp_set_msgAlert"==e.target.id)if(e.target.checked)O.msgAlertSettings(e.target);else{var l=O.qs("#SP_PLUS_MSGALERTSETTINGS");l&&O.remove(l)}else"sp_set_sticker"==e.target.id?e.target.checked?O.freeStickers():document.location.reload():"sp_set_fixes"==e.target.id&&(e.target.checked?(O.tinyFix(),O.alert("Незначительные исправления<div class='pad_t_a'></div><small class='pad_t_a grey'>Данная функция необходима для исправления неудачных обновлений сайта.<div class='pad_t_a'></div>Исправлено: <ul><li>Кнопка почты/ленты в шапке</li></ul></div>",1,1)):(r&&O.remove(r),document.location.reload()))}});if(void 0!==w[s]){var i=O.ce("label",{html:w[s],attr:{for:"sp_set_"+s}}),l=O.ce("label",{class:"stnd-link bstrwrap"});l.appendChild(n),l.appendChild(i),a.appendChild(l),a.appendChild(l)}}A.friendsOn&&O.setFriend(O.qs("#sp_set_friendsOn")),A.myEvents&&O.evenstSupport(O.qs("#sp_set_myEvents")),A.bodystyle&&O.bgSettings(O.qs("#sp_set_bodystyle")),A.msgAlert&&O.msgAlertSettings(O.qs("#sp_set_msgAlert"));var o=O.ce("div",{class:"sp_plus_line",html:"<span class='sp_plus_text'>Встроенные возможности сайта</span>"}),c=O.ce("div",{class:"sp_plus_line",html:"<span class='sp_plus_text'>Дополнительные функции</span>"}),d=O.ce("div",{class:"sp_plus_line",html:"<span class='sp_plus_text'>Прочее</span>"});a.appendChild(o),O.spacesAction(a),O.newbequest(),a.appendChild(c);var p=O.ce("a",{href:E+"//"+N+"/settings/?sp_plus_settings=1&sp_cookie_editor=1",class:"stnd-link stnd-link_arr",id:"sp_cookie_editor",html:"<span class='b'><span class='sp sp-write-grey'></span> Редактор cookies<span class='ico ico_arr ico_m'></span></span>",style:"font-size: small; border-bottom: unset;",onclick:function(){var e=O.qs("#SP_PLUS_SETHEAD"),t=O.qs("#SP_PLUS_SETHEAD2"),a=O.qs("#SP_PLUS_SETBACK");return e&&(e.innerHTML="Редактор cookies"),t&&(t.innerHTML='<a href="http://'+N+'/settings/?sp_plus_settings=1" style="margin-bottom: 1px;">Spaces+</a><span class="location-bar__sep ico"></span> Редактор cookies'),a&&(a.href=E+"//"+N+"/settings/?sp_plus_settings=1"),/(\&)sp_cookie_editor=1/i.test(S)||O.historyPush({sp_plus_settings:y,sp_cookie_editor:k},E+"//"+N+"/settings/?sp_plus_settings=1&sp_cookie_editor=1","Spaces+: Редактор cookies"),O.cookieEditor("#SP_PLUS_SETAREA"),!1}});a.appendChild(p),a.appendChild(d);var u=O.ce("a",{href:E+"//"+N+"/settings/?sp_plus_settings=1&sp_backup=1",class:"stnd-link stnd-link_arr",id:"sp_backup",html:"<span class='b' style='color: #2e7d32'><span class='sp sp-backup-g'></span> Импорт и экспорт параметров<span class='ico ico_arr ico_m'></span></span>",style:"font-size: small;",onclick:function(){var e=O.qs("#SP_PLUS_SETHEAD"),t=O.qs("#SP_PLUS_SETHEAD2"),a=O.qs("#SP_PLUS_SETBACK");return e&&(e.innerHTML="Импорт и экспорт параметров"),t&&(t.innerHTML='<a href="http://'+N+'/settings/?sp_plus_settings=1" style="margin-bottom: 1px;">Spaces+</a><span class="location-bar__sep ico"></span> Импорт и экспорт параметров'),a&&(a.href=E+"//"+N+"/settings/?sp_plus_settings=1"),/(\&)sp_backup=1/i.test(S)||O.historyPush({sp_plus_settings:y,sp_backup:x},E+"//"+N+"/settings/?sp_plus_settings=1&sp_backup=1","Spaces+: Импорт и экспорт параметров"),O.spacesBackup("#SP_PLUS_SETAREA"),!1}});a.appendChild(u);var m=O.ce("a",{href:E+"//"+N+"/settings/?sp_plus_settings=1&sp_changelog=1",class:"stnd-link stnd-link_arr",id:"sp_changelog",html:"<span class='b' style='color: #2196f3'><span class='sp sp-restore-blue'></span> История обновлений<span class='ico ico_arr ico_m'></span></span>",style:"font-size: small;",onclick:function(){var e=O.qs("#SP_PLUS_SETHEAD"),t=O.qs("#SP_PLUS_SETHEAD2"),a=O.qs("#SP_PLUS_SETBACK");return e&&(e.innerHTML="История обновлений"),t&&(t.innerHTML='<a href="http://'+N+'/settings/?sp_plus_settings=1" style="margin-bottom: 1px;">Spaces+</a><span class="location-bar__sep ico"></span> История обновлений'),a&&(a.href=E+"//"+N+"/settings/?sp_plus_settings=1"),/(\&)sp_changelog=1/i.test(S)||O.historyPush({sp_plus_settings:y,sp_changelog:C},E+"//"+N+"/settings/?sp_plus_settings=1&sp_changelog=1","Spaces+: История обновлений"),O.spacesChangelog("#SP_PLUS_SETAREA"),!1}});a.appendChild(m);var g=O.ce("a",{href:"#",class:"stnd-link stnd-link_arr",id:"sp_plus_reset",html:"<span class='b' style='color: #f86934;'><span class='sp sp-alert'></span> Сброс настроек<span class='ico ico_arr ico_m'></span></span>",style:"font-size: small;",onclick:function(){return O.confirmm("Вы действительно хотите сбросить настройки?",0,function(){O.delCookie("SP_PLUS_SET"),O.delCookie("gp_left_btn"),O.delCookie("force_ajax_transport"),O.delCookie("sandbox"),document.location.reload()}),!1}});a.appendChild(g);var _=O.ce("div",{class:"widgets-group widgets-group_top nl wbg"}),v=O.ce("div",{class:"content-item3"}),f=O.ce("div",{class:"grey",html:"Developed by <a href='https://crashmax.ru' target='_blank'>crashmax</a> with love ❤️"}),h=O.ce("div",{style:"float: right;",html:"v"+O.rever(P)}),b=O.qs("#SP_PLUS_ABOUT");_.appendChild(v),v.appendChild(f),f.appendChild(h),b.appendChild(_)}return!1}});if(O.inBefore(a,t),"BR"==t.nextElementSibling.nodeName&&O.insertAfter(O.ce("br",null),a),y){document.title="Настройки Spaces+";var s=document.createEvent("MouseEvent"),n=document.createEvent("MouseEvent");s.initEvent("click",!0,!0),a.dispatchEvent(s),k?(document.title="Spaces+: Редактор cookies",n.initEvent("click",!0,!0),O.qs("#sp_cookie_editor").dispatchEvent(n)):C?(document.title="Spaces+: История обновлений",n.initEvent("click",!0,!0),O.qs("#sp_changelog").dispatchEvent(n)):x&&(document.title="Spaces+: Импорт и экспорт параметров",n.initEvent("click",!0,!0),O.qs("#sp_backup").dispatchEvent(n))}}}catch(e){O.console.error("Ошибка (SETTINGS): "+e.name+":"+e.message+"\n"+e.stack)}},notifications:function(t,a,s){try{"Notification"in window?"granted"==Notification.permission.toLowerCase()?O.notificationShow(t,a,s):"denied"!=Notification.permission.toLowerCase()?Notification.requestPermission(function(e){"granted"==e.toLowerCase()?O.notificationShow(t,a,s):O.alert("Вы <b style='color: #800;'>запретили</b> показывать уведомления для сайта "+N+"!<br/>Зайдите в настройки браузера и настройте доступ.",1,null)}):O.alert("Разрешите браузеру показывать уведомления с сайта "+N+", чтобы пользоваться функцией!",1,null):O.alert("Ваш браузер не поддерживает уведомления!",1,null)}catch(e){O.console.error("Ошибка (NOTIFICATIONS): "+e.name+":"+e.message+"\n"+e.stack)}},notificationShow:function(e,t,a){try{var s=new Notification(e,t);null!=a&&(s.onclick=function(e){e.preventDefault(),O.setLocation(a),e.target.close()})}catch(e){O.console.error("Ошибка (NOTIFICATION-SHOW): "+e.name+":"+e.message+"\n"+e.stack)}},setFriend:function(e){try{var t=O.ce("div",{id:"SP_PLUS_MAXFRIENDS"}),a=O.ce("div",{style:"padding: 11px 15px;"}),s=O.ce("label",{class:"stnd-link",style:"border-top: unset;"}),n=O.ce("input",{type:"text",class:"text-input",size:4,attr:{maxlength:2},value:A.friendsOnMax});n.onchange=n.oninput=function(e){if(isNaN(e.target.value))n.className="text-input sp-input-error";else{var t=parseInt(e.target.value,10);n.className="text-input",(15<t||t<1)&&(t=10,n.className="text-input sp-input-error"),o=0,A.friendsOnMax=t;var a=JSON.stringify(A);O.setCookie("SP_PLUS_SET",a,null),O.friendsOnline(1)}};var i=O.ce("label",{html:'Выводить друзей:<div class="label__desc">от 1 до 15</div>',class:"label"}),l=O.ce("input",{type:"checkbox",id:"sp_friends_list_sh",class:"sp-checkbox-square",checked:A.friendsListSH,onclick:function(e){A.friendsListSH=e.target.checked;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null)}}),r=O.ce("label",{attr:{for:"sp_friends_list_sh"},html:"Скрывать/показывать по клику на счётчике"});a.appendChild(i),a.appendChild(n),s.appendChild(l),s.appendChild(r),t.appendChild(a),t.appendChild(s),O.insertAfter(t,e.parentNode)}catch(e){O.console.error("Ошибка (FRIENDS-MAX-SUPPORT): "+e.name+":"+e.message+"\n"+e.stack)}},bgSettings:function(e){try{var t=O.ce("div",{id:"SP_PLUS_BODYSTYLE"}),a=O.ce("div",{class:"bstrwrap",style:"border-bottom: unset; padding: 15px;"}),s=O.ce("div",{class:"text-input__wrap"}),n=O.ce("label",{class:"stnd-link",style:"border-bottom: unset;"}),i=O.ce("label",{class:"stnd-link",style:"border-bottom: unset;"}),l=O.ce("label",{html:'Ссылка на изображение:<div class="label__desc">.jpg или .png</div>',style:"margin-right: -17px;",class:"label"}),r=O.ce("label",{html:'Цвет фона:<div class="label__desc">#RRGGBB</div>',style:"margin-right: -17px;",class:"label"}),o=O.ce("input",{type:"text",value:A.bodystyleSetting.url,style:"margin-bottom: 7px;",class:"text-input"});o.onchange=o.oninput=function(e){if(O.isValidUrl(e.target.value)&&/\.(jpg|jpeg|png|gif)$/i.test(e.target.value)||""==O.trim(e.target.value)){A.bodystyleSetting.url=O.trim(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),o.className="text-input"}else o.className="text-input sp-input-error"};var c=O.ce("input",{type:"text",class:"text-input",id:"color-input",value:A.bodystyleSetting.color});c.onchange=c.oninput=function(e){if(/^\#([A-Za-z0-9]{3}|[A-Za-z0-9]{6})$/i.test(e.target.value)||""==e.target.value){A.bodystyleSetting.color=O.trim(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),c.className="text-input"}else c.className="text-input sp-input-error"};var d=O.ce("input",{type:"radio",id:"sp_set_bodystyle_URL",checked:A.bodystyleSetting.urlchecked,class:"sp-checkbox-circle",onclick:function(e){A.bodystyleSetting.urlchecked=e.target.checked,e.target.checked&&p.checked&&(p.checked=!1,A.bodystyleSetting.colorchecked=!1);var t=JSON.stringify(A);if(O.setCookie("SP_PLUS_SET",t,null),1==A.bodystyleSetting.urlchecked)O.setStyle(),O.bgImage(e.target);else{var a=O.qs("#SP_WRAP_IMAGE");a&&O.remove(a)}}}),p=O.ce("input",{type:"radio",id:"sp_set_bodystyle_color",checked:A.bodystyleSetting.colorchecked,class:"sp-checkbox-circle",onclick:function(e){A.bodystyleSetting.colorchecked=e.target.checked,e.target.checked&&d.checked&&(d.checked=!1,A.bodystyleSetting.urlchecked=!1);var t=JSON.stringify(A);if(O.setCookie("SP_PLUS_SET",t,null),1==A.bodystyleSetting.colorchecked)O.setStyle(),O.bgColor(e.target);else{var a=O.qs("#SP_WRAP_COLOR");a&&O.remove(a)}}}),u=O.ce("label",{attr:{for:"sp_set_bodystyle_URL"},html:"Выбрать изображение"}),m=O.ce("label",{attr:{for:"sp_set_bodystyle_color"},html:"Подобрать цвет"});s.appendChild(l),s.appendChild(o),s.appendChild(r),s.appendChild(c),n.appendChild(d),n.appendChild(u),i.appendChild(p),i.appendChild(m),a.appendChild(s),t.appendChild(a),t.appendChild(n),t.appendChild(i),O.insertAfter(t,e.parentNode),A.bodystyleSetting.urlchecked&&O.bgImage(),A.bodystyleSetting.colorchecked&&O.bgColor()}catch(e){O.console.error("Ошибка (BODYSTYLE-SET): "+e.name+":"+e.message+"\n"+e.stack)}},bgColor:function(){var e=O.service(1);try{if(!O.qs("#SP_WRAP_COLOR")){O.qs("#SP_WRAP_IMAGE")&&(O.remove(O.qs("#SP_WRAP_IMAGE")),O.remove(O.qs("#SP_PLUS_IMAGE_STYLE")));var t=O.ce("link",{rel:"stylesheet",type:"text/css",id:"SP_PLUS_CP_STYLE",href:"https://"+L+"/src/attaches/css/toolbar.css?r="+e}),a=O.ce("link",{rel:"stylesheet",type:"text/css",id:"SP_PLUS_CP_STYLE_2",href:"https://"+L+"/src/attaches/css/user-content.css?r="+e});document.getElementsByTagName("head")[0].appendChild(t),document.getElementsByTagName("head")[0].appendChild(a);var s=O.qs("#SP_PLUS_BODYSTYLE"),n=O.ce("div",{id:"SP_WRAP_COLOR",style:"border-top: 1px solid #cdd4e1;"}),i=O.ce("table",{class:"table__wrap bb-colorpicker"}),l=O.ce("tbody"),r=O.ce("tr"),o=O.ce("td",{class:"table__cell"}),c=O.ce("div",{class:"stnd-block",html:'<div><div style="background-color:#90CAF9" data-tag="fon" data-val="#90CAF9" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#80DEEA" data-tag="fon" data-val="#80DEEA" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#A5D6A7" data-tag="fon" data-val="#A5D6A7" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#FFF59D" data-tag="fon" data-val="#FFF59D" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#FFCC80" data-tag="fon" data-val="#FFCC80" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#FFAB91" data-tag="fon" data-val="#FFAB91" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#CE93D8" data-tag="fon" data-val="#CE93D8" class="js-bb_color toolbar-color pointer"></div> </div> <div> <div style="background-color:#2196F3" data-tag="fon" data-val="#2196F3" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#00BCD4" data-tag="fon" data-val="#00BCD4" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#4CAF50" data-tag="fon" data-val="#4CAF50" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#FFEB3B" data-tag="fon" data-val="#FFEB3B" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#FF9800" data-tag="fon" data-val="#FF9800" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#F44336" data-tag="fon" data-val="#F44336" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#9C27B0" data-tag="fon" data-val="#9C27B0" class="js-bb_color toolbar-color pointer"></div> </div> <div> <div style="background-color:#1565C0" data-tag="fon" data-val="#1565C0" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#00838F" data-tag="fon" data-val="#00838F" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#2E7D32" data-tag="fon" data-val="#2E7D32" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#F9A825" data-tag="fon" data-val="#F9A825" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#EF6C00" data-tag="fon" data-val="#EF6C00" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#C62828" data-tag="fon" data-val="#C62828" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#6A1B9A" data-tag="fon" data-val="#6A1B9A" class="js-bb_color toolbar-color pointer"></div> </div> <div> <div style="background-color:#ECF0F1" data-tag="fon" data-val="#ECF0F1" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#CFD8DC" data-tag="fon" data-val="#CFD8DC" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#B0BEC5" data-tag="fon" data-val="#B0BEC5" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#97A6B0" data-tag="fon" data-val="#97A6B0" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#546E7A" data-tag="fon" data-val="#546E7A" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#44565E" data-tag="fon" data-val="#44565E" class="js-bb_color toolbar-color pointer"></div> <div style="background-color:#3A474C" data-tag="fon" data-val="#3A474C" class="js-bb_color toolbar-color pointer"></div></div>'});o.appendChild(c),r.appendChild(o);var d=O.ce("td",{class:"table__cell table__cell_last"}),p=O.ce("div",{class:"stnd-block"}),u=O.ce("div",{class:"js-bb_colorpicker"});p.appendChild(u),d.appendChild(p),r.appendChild(d),l.appendChild(r),i.appendChild(l),n.appendChild(i),s.appendChild(n);var m=u;setTimeout(function(){var s=new CP(m,!1,m);document.getElementById("color-input").onchange=document.getElementById("color-input").oninput=function(e){if(/^\#([A-Za-z0-9]{3}|[A-Za-z0-9]{6})$/i.test(e.target.value)||""==e.target.value){e.target.className="text-input",A.bodystyleSetting.color=O.trim(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),s.set(A.bodystyleSetting.color)}else e.target.className="text-input sp-input-error"},s.enter(),s.set(A.bodystyleSetting.color),s.on("change",function(e){document.getElementsByClassName("text-input")[3].value="#"+e,document.querySelector("input[name=color]").value="#"+e,document.getElementsByClassName("colorpicker-color")[0].style.backgroundColor="#"+e,A.bodystyleSetting.color="#"+e;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle()});for(var e=document.getElementsByClassName("js-bb_color toolbar-color pointer"),t=0;t<e.length;t++)e[t].onclick=function(e){var t=e.target.getAttribute("data-val");document.getElementsByClassName("text-input")[3].value=t,document.querySelector("input[name=color]").value=t,document.getElementsByClassName("colorpicker-color")[0].style.backgroundColor=t,A.bodystyleSetting.color=t;var a=JSON.stringify(A);O.setCookie("SP_PLUS_SET",a,null),O.setStyle(),s.set(t)}},1)}}catch(e){O.console.error("Ошибка (BODYSTYLE-COLOR-SET): "+e.name+":"+e.message+"\n"+e.stack)}},bgImage:function(){var e=O.service(1);try{if(!O.qs("#SP_WRAP_IMAGE")){O.qs("#SP_WRAP_COLOR")&&(O.remove(O.qs("#SP_WRAP_COLOR")),O.remove(O.qs("#SP_PLUS_CP_STYLE")));var t=O.ce("link",{rel:"stylesheet",type:"text/css",id:"SP_PLUS_IMAGE_STYLE",href:"https://"+L+"/src/attaches/css/bodystyle.css?r="+e});document.getElementsByTagName("head")[0].appendChild(t);var r=O.qs("#SP_PLUS_BODYSTYLE"),o=O.ce("div",{id:"SP_WRAP_IMAGE",style:"border-top: 1px solid #cdd4e1;"}),c=O.ce("div",{class:"js-gallery_skip wbg oh tiles_block tiles_wrapper"});O.ajax("https://"+L+"/data.json?r="+e,"GET",null,function(e){e=JSON.parse(e);for(var t=0;t<e.backgrounds.length;t++){var a=O.ce("div",{class:"js-file_item tiled_item tiled_item-200"}),s=O.ce("div",{class:"tiled_inner t_center relative"}),n=O.ce("span",{class:"relative",style:"display: inline-block;max-width: 100%; width: 100%;"}),i=O.ce("div",{class:"tiled-preview border"}),l=O.ce("img",{class:"preview s201_200",style:"cursor: pointer;",src:e.backgrounds[t].url,onclick:function(e){document.getElementsByClassName("text-input")[2].value=e.target.src,A.bodystyleSetting.url=e.target.src;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle()}});i.appendChild(l),n.appendChild(i),s.appendChild(n),a.appendChild(s),c.appendChild(a)}o.appendChild(c),r.appendChild(o)},4)}}catch(e){O.console.error("Ошибка (BODYSTYLE-IMAGE-SET): "+e.name+":"+e.message+"\n"+e.stack)}},evenstSupport:function(e){try{var t=O.ce("div",{id:"SP_PLUS_EVENTS"}),a=O.ce("input",{type:"checkbox",id:"sp_event_notif",class:"sp-checkbox-square",checked:A.events.notifications,onclick:function(a){if(!("Notification"in window))return O.alert("Ваш браузер не поддерживает уведомления!",1,null),!1;if("granted"==Notification.permission.toLowerCase()){A.events.notifications=a.target.checked;var e=JSON.stringify(A);O.setCookie("SP_PLUS_SET",e,null)}else{if("denied"==Notification.permission.toLowerCase())return O.alert("Вы <b style='color: #800;'>запретили</b> показывать уведомления для сайта "+N+"!<br/>Зайдите в настройки браузера и настройте доступ (для Google Chrome включите HTTPS-протокол).",1,null),!1;Notification.requestPermission(function(e){if("granted"!=e.toLowerCase())return O.alert("Разрешите браузеру показывать уведомления с сайта "+N+", чтобы пользоваться функцией!",1,null),!1;A.events.notifications=a.target.checked;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null)})}}}),s=O.ce("label",{attr:{for:"sp_event_notif"},html:"Уведомления в браузере"}),n=O.ce("label",{html:'Ссылка на аудиофайл:<div class="label__desc">.ogg или .wav</div>',style:"margin-right: -17px;",class:"label"}),i=O.ce("label",{html:"Громкость:",class:"label"}),l=O.ce("div",{class:"text-input__wrap",style:"margin: 15px;"}),r=O.ce("div",{style:"margin: 15px;"}),o=O.ce("label",{class:"stnd-link",style:"border-top: unset; border-bottom: unset;"}),c=O.ce("label",{class:"stnd-link",style:"border-top: unset; border-bottom: unset;"}),d=O.ce("label",{class:"stnd-link",style:"border-top: unset; border-bottom: unset;"}),p=O.ce("label",{class:"stnd-link",style:"border-top: unset; border-bottom: unset;"}),u=O.ce("input",{type:"text",value:A.events.url,class:"text-input"});u.onchange=u.oninput=function(e){if(O.isValidUrl(e.target.value)&&/\.(ogg|mp3|wav)$/i.test(e.target.value)||""==O.trim(e.target.value)){A.events.url=O.trim(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),u.className="text-input"}else u.className="text-input sp-input-error"};var m=O.ce("span",{class:"text-input__btn",html:'<span class="js-ico sp sp-play-green"></span>',style:"margin-left: 7px; font-size: small; top: 23px",title:"Прослушать",onclick:function(){return O.sound(A.events.url,A.events.volume),!1}}),g=O.ce("div",{class:"label__desc",html:A.events.volume+"%"}),_=O.ce("input",{type:"range",min:0,max:100,step:1,value:A.events.volume});_.onchange=_.oninput=function(e){if(!isNaN(e.target.value)){var t=parseInt(e.target.value,10);(t<0||100<t)&&(t=70),g.innerHTML=t+"%",A.events.volume=t;var a=JSON.stringify(A);O.setCookie("SP_PLUS_SET",a,null)}};var v=O.ce("input",{type:"checkbox",id:"sp_event_mail",class:"sp-checkbox-square",checked:A.events.mail,onclick:function(e){A.events.mail=e.target.checked;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null)}}),f=O.ce("label",{attr:{for:"sp_event_mail"},html:"Уведомлять о почте"}),h=O.ce("input",{type:"checkbox",id:"sp_event_journal",class:"sp-checkbox-square",checked:A.events.journal,onclick:function(e){A.events.journal=e.target.checked;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null)}}),b=O.ce("label",{attr:{for:"sp_event_journal"},html:"Уведомлять о журнале"}),S=O.ce("input",{type:"checkbox",id:"sp_event_feed",class:"sp-checkbox-square",checked:A.events.feed,onclick:function(e){A.events.feed=e.target.checked;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null)}}),y=O.ce("label",{attr:{for:"sp_event_feed"},html:"Уведомлять о ленте"});l.appendChild(n),l.appendChild(u),l.appendChild(m),i.appendChild(g),r.appendChild(i),r.appendChild(_),t.appendChild(l),t.appendChild(r),o.appendChild(a),o.appendChild(s),c.appendChild(v),c.appendChild(f),d.appendChild(h),d.appendChild(b),p.appendChild(S),p.appendChild(y),t.appendChild(o),t.appendChild(c),t.appendChild(d),t.appendChild(p),O.insertAfter(t,e.parentNode)}catch(e){O.console.error("Ошибка (EVENTS-SUP): "+e.name+":"+e.message+"\n"+e.stack)}},historyPush:function(e,t,a){try{document.title=a,history.pushState(e,a,t)}catch(e){O.console.error("Ошибка (HISTORY): "+e.name+":"+e.message+"\n"+e.stack)}},remove:function(e){return e.parentNode.removeChild(e)},scrollMove:function(){try{var e=O.qs("#scroll_page");e&&!e.hasAttribute("sp-replace")?(e.style.left="auto",e.style.right="0",e.setAttribute("sp-replace","1")):!A.rscroll&&e&&e.hasAttribute("sp-replace")&&(e.style.left="0",e.style.right="auto",e.removeAttribute("sp-replace"))}catch(e){O.console.error("Ошибка (SCROLLER): "+e.name+":"+e.message+"\n"+e.stack)}},hiddenRightbar:function(){try{var e=O.qs("#page_rightbar");e&&!e.hasAttribute("sp-hidden-rightbar")?(e.style.display="none",e.setAttribute("sp-hidden-rightbar","1")):!A.hrightbar&&e&&e.hasAttribute("sp-hidden-rightbar")&&(e.style.display="block",e.removeAttribute("sp-hidden-rightbar"))}catch(e){O.console.error("Ошибка (HRIGHTBAT): "+e.name+":"+e.message+"\n"+e.stack)}},cookieEditor:function(e){window.scrollTo(0,0);var t=O.allCookie(),a=O.qs(e);if(a)try{if(a.innerHTML="",!A.hideNotyf.cookieEditor){var s=O.ce("span",{class:"sp sp-remove-grey pointer right notif_close close_h",style:"margin: 10px",title:"Понятно, больше не показывать.",onclick:function(){A.hideNotyf.cookieEditor=!0;var e=JSON.stringify(A);O.setCookie("SP_PLUS_SET",e,null),O.cookieEditor("#SP_PLUS_SETAREA")}}),n=O.ce("div",{class:"stnd-block-yellow",style:"padding: 15px;",html:'<span class="sp sp-alert"></span>Внимание!</br></br><div style="font-size: small;">Никому не сообщайте значения ваших cookies! Не делайте скриншот этой страницы, на котором будут видны эти значения! От этого зависит безопасность вашего аккаунта!</div>'}),i=O.ce("div");i.appendChild(s),a.appendChild(i),i.appendChild(n)}var l=O.ce("div",{style:"text-align: center; padding-top: 10px;"}),r=O.ce("input",{type:"text",class:"text-input",placeholder:"Имя",style:"width: 30%; margin: 3px;"}),o=O.ce("input",{type:"text",class:"text-input",placeholder:"Значение",style:"width: 30%; margin: 3px;"}),c=O.ce("button",{html:'<span class="sp sp-ok-blue"></span> Добавить',class:"black",style:"max-width: 30%; margin: 3px; padding: 5px 3px 3px 7px; font-size: 14px;",onclick:function(e){var t="SPAN"==e.target.nodeName?e.target.parentNode.previousElementSibling:e.target.previousElementSibling,a=O.htmlspecialchars(O.trim(t.previousElementSibling.value)),s=O.htmlspecialchars(O.trim(t.value));"SP_PLUS_SET"==a?O.alert("Внимание!<div class='pad_t_a'></div><small>Это служебное значение скрипта, не изменяйте его!</small>",1,null):""!=a&&""!=s?O.confirmm("SP_PLUS_SET"==a?"Внимание, <b>"+a+"</b> является служебным значение скрипта, не стоит его изменять!<br/>":"Вы действительно хотите добавить куку <b>"+a+"</b> со значением <b>"+s+"</b>?",1,function(){O.setCookie(t.previousElementSibling.value,t.value,null),O.cookieEditor("#SP_PLUS_SETAREA")}):O.alert("Внимание!<div class='pad_t_a'></div><small>Отсутсвует имя или значение!</small>",1,null)}});for(var d in l.appendChild(r),l.appendChild(o),l.appendChild(c),a.appendChild(l),a.appendChild(O.ce("div",{class:"sp_plus_line",html:'<span class="sp_plus_text">Список существующий cookies</span>'})),t)if("SP_PLUS_SET"!=d){var p=O.ce("div",{class:"text-input__wrap",style:"text-align: center;"}),u=O.ce("input",{type:"text",class:"text-input",placeholder:"Имя",attr:{readonly:"readonly"},value:d,style:"width: 30%; margin: 3px;",onclick:function(e){e.target.select()}}),m=O.ce("input",{type:"text",class:"text-input",placeholder:"Значение",value:t[d],style:"width: 30%; margin: 3px;"}),g=O.ce("button",{html:"<span class='ico ico_delete'></span>",title:"Удалить",style:"max-width: 15%; margin: 3px; padding: 5px 3px 3px 7px; font-size: 14px;",onclick:function(e){var t="SPAN"==e.target.nodeName?e.target.parentNode.previousElementSibling.previousElementSibling:e.target.previousElementSibling.previousElementSibling,a=O.htmlspecialchars(O.trim(t.value));"SP_PLUS_SET"==a?O.alert("Внимание!<div class='pad_t_a'></div><small>Это служебное значение скрипта, не изменяйте его!</small>",1,null):""!=a?O.confirmm("SP_PLUS_SET"==a?"Внимание, <b>"+a+"</b> является служебным значение скрипта, не стоит его удалять!<br/>":"Вы действительно хотите удалить куку <b>"+a+"</b>?",0,function(){O.delCookie(t.value),O.cookieEditor("#SP_PLUS_SETAREA")}):O.alert("Пустую куку удалить?! Ты, блять, серьёзно???",1,null)}}),_=O.ce("button",{title:"Сохранить",html:"<span class='sp sp-ok-blue'></span>",style:"max-width: 15%; margin: 3px; padding: 5px 3px 3px 7px; font-size: 14px;",onclick:function(e){var t="SPAN"==e.target.nodeName?e.target.parentNode.previousElementSibling.previousElementSibling:e.target.previousElementSibling.previousElementSibling,a=O.htmlspecialchars(O.trim(t.previousElementSibling.value)),s=O.htmlspecialchars(O.trim(t.value));"SP_PLUS_SET"==a?O.alert("Внимание!<div class='pad_t_a'></div><small>Это служебное значение скрипта, не изменяйте его!</small>",1,null):""!=a&&""!=s?O.confirmm("SP_PLUS_SET"==a?"Внимание, "+a+"</b> является служебным значение скрипта, не стоит его изменять!<br/>":"Вы действительно хотите задать куке <b>"+a+"</b> значение <b>"+s+"</b>?",1,function(){O.setCookie(t.previousElementSibling.value,t.value,null),O.cookieEditor("#SP_PLUS_SETAREA")}):O.alert("Внимание!<div class='pad_t_a'></div><small>Отсутсвует имя или значение!</small>",1,null)}});p.appendChild(u),p.appendChild(m),p.appendChild(g),p.appendChild(_),a.appendChild(p)}}catch(e){O.console.error("Ошибка (COOKIE-EDITOR): "+e.name+":"+e.message+"\n"+e.stack)}},spacesAction:function(e){var t=O.ce("div",{id:"wrap_spaces_option"}),a=O.ce("a",{href:"#",class:"stnd-link stnd-link_arr",html:A.apidebug?'<span class="b"><span class="sp sp-remove-grey"></span> Убрать отладчик<span class="ico ico_arr ico_m"></span></span>':'<span class="b"><span class="ico ico_settings"></span> Включить отладчик<span class="ico ico_arr ico_m"></span></span>',style:"font-size: small;",onclick:function(){if(A.apidebug){var e=O.qs("#spaces_api_debugger");A.apidebug=!1;t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.remove(e),O.setLocation(document.location.href)}else{A.apidebug=!0;var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.apiDebugger(),O.setLocation(document.location.href)}return!1}}),s=O.getCookie("beta"),n=O.ce("a",{href:"#",class:"stnd-link stnd-link_arr",id:"sp_spacesAction_beta",html:s?"<span class='b'><span class='sp sp-exit-grey'></span> Выйти из песочницы<span class='ico ico_arr ico_m'></span></span>":"<span class='b'><span class='sp sp-enter-grey'></span> Beta-песочница<span> - открытое тестирование нововведений сайта<span class='ico ico_arr ico_m'></span></span></span>",style:"font-size: small;",onclick:function(){return s?O.delCookie("sandbox"):O.setCookie("sandbox","beta",null),document.location.reload(),!1}}),i=O.getCookie("force_ajax_transport"),l=O.ce("a",{href:"#",class:"stnd-link stnd-link_arr",id:"sp_spacesFAT",html:i?"<span class='b'><span class='sp sp-remove-grey'></span> Убрать полосу загрузки<span class='ico ico_arr ico_m'></span></span>":"<span class='b'><span class='ico ico_ok_grey'></span> Добавить полосу загрузки страницы<span class='ico ico_arr ico_m'></span><span>",style:"font-size: small;",onclick:function(){return i?O.delCookie("force_ajax_transport"):O.setCookie("force_ajax_transport","1",null),document.location.reload(),!1}}),r=O.getCookie("gp_left_btn"),o=O.ce("a",{href:"#",class:"stnd-link stnd-link_arr",id:"sp_spacesGLB",html:r?"<span class='b'><span class='sp sp-remove-grey'></span> Убрать плеер из панели<span class='ico ico_arr ico_m'></span></span>":"<span class='b'><span class='ico ico_ok_grey'></span> Переместить плеер - переносит кнопку открытия плеера в левую панель<span class='ico ico_arr ico_m'></span></span>",style:"border-bottom: unset; font-size: small;",onclick:function(){return r?O.delCookie("gp_left_btn"):O.setCookie("gp_left_btn","1",null),document.location.reload(),!1}}),c=O.ce("a",{href:"#",style:"border-bottom: unset; display: none; font-size: small;",id:"sp_newbequest_togl",class:"stnd-link stnd-link_arr sp_line",html:"<span class='b'><span class='sp sp-remove-grey'></span> Скрыть квест новичка<span class='ico ico_arr ico_m'></span></span>",onclick:function(){var e=O.getCK(0);return O.confirmm("Вы действительно хотите скрыть квест новичка?",0,function(){O.ajax(E+"//"+N+"/newbequest/?CK="+e,"GET",null,function(){O.alert("Успех!<div class='pad_t_a'></div><small>Квест новичка скрыт</small>",1,null)},2),setTimeout(function(){O.newbequest()},1e3)}),!1}});t.appendChild(a),t.appendChild(n),t.appendChild(l),t.appendChild(o),t.appendChild(c),e.appendChild(t)},setLocation:function(e){e=e||document.location.href.toString();var t=O.qs("#SP_PLUS_SETLOCATIONLINK"),a=document.createEvent("MouseEvent");a.initEvent("click",!0,!0),t?t.href=e:(t=O.ce("a",{href:e,style:"display: none;",id:"SP_PLUS_SETLOCATIONLINK"}),document.body.appendChild(t)),t.dispatchEvent(a)},isValidUrl:function(e){return/^(?:(?:https?|ftp|telnet):\/\/(?:[а-я0-9_-]{1,32}(?::[а-я0-9_-]{1,32})?@)?)?(?:(?:[а-я0-9-]{1,128}\.)+(?:рф)|(?! 0)(?:(?! 0[^.]|255)[ 0-9]{1,3}\.){3}(?! 0|255)[ 0-9]{1,3})(?:\/[a-zа-я0-9.,_@%&?+=\~\/-]*)?(?:#[^ \'\"&<>]*)?$/i.test(e)||/^(?:(?:https?|ftp|telnet):\/\/(?:[a-z0-9_-]{1,32}(?::[a-z0-9_-]{1,32})?@)?)?(?:(?:[a-z0-9-]{1,128}\.)+(?:com|net|org|mil|edu|arpa|ru|gov|biz|info|aero|inc|name|[a-z]{2})|(?! 0)(?:(?! 0[^.]|255)[ 0-9]{1,3}\.){3}(?! 0|255)[ 0-9]{1,3})(?:\/[a-zа-я0-9.,_@%&?+=\~\/-]*)?(?:#[^ \'\"&<>]*)?$/i.test(e)},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},inBefore:function(e,t){return t.parentNode.insertBefore(e,t)},insertAfter:function(e,t){var a=t.parentNode,s=t.nextSibling;if(a)return s?a.insertBefore(e,s):a.appendChild(e)},qs:function(e){return document.querySelector(e)},getClassName:function(e,t){for(var a=new Array,s=(e=e.split("."),document.getElementsByTagName(e[0])),n=0;n<s.length;n++)0<=s[n].className.indexOf(e[1])&&!t?a.push(s[n]):s[n].className==e[1]&&t&&a.push(s[n]);return a[0]?a:null},declOfNum:function(e,t){return t[4<e%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]},console:{info:function(e){var t=new Date;e="("+(t.getHours()<10?"0":"")+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+":"+(t.getSeconds()<10?"0":"")+t.getSeconds()+") "+e,console.info(e),t=null},error:function(e){var t=new Date;e="("+(t.getHours()<10?"0":"")+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+":"+(t.getSeconds()<10?"0":"")+t.getSeconds()+") "+e,console.error(e),t=null},log:function(e){var t=new Date;e="("+(t.getHours()<10?"0":"")+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+":"+(t.getSeconds()<10?"0":"")+t.getSeconds()+") "+e,console.log(e),t=null},debug:function(e){var t=new Date;e="("+(t.getHours()<10?"0":"")+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+":"+(t.getSeconds()<10?"0":"")+t.getSeconds()+") "+e,console.debug(e),t=null}},time2str:function(e){var t=parseInt(e,10);if(isNaN(t))return O.console.info(t),null;var a=parseFloat(t/3600).toFixed(2).toString();return(a=a.split("."))[0]+" ч, "+parseInt(a[1]/(100/60),10)+" мин"},sound:function(e,t){try{var a=new Audio(e);a.volume=t/100,a.play()}catch(e){O.console.error("Ошибка (SOUND): "+e.name+":"+e.message+"\n"+e.stack)}},soundEvents:function(){try{var e={mail:O.qs("#mail_notif_cnt"),journal:O.qs("#jour_notif_cnt"),feed:O.qs("#lent_notif_cnt")},t=O.getCookie("spacesactive"),a=0;for(var s in e)e[s]&&A.events[s]&&""!=e[s].innerHTML&&!isNaN(e[s].innerHTML)&&(a+=parseInt(e[s].innerHTML,10));if(T<a){if(O.sound(A.events.url,A.events.volume),A.events.notifications){var n=O.declOfNum(a,["новое событие","новых события","новых событий"]);O.notifications("Новые события на Spaces!",{body:"У Вас "+a+" "+n+"!",icon:"data:image/png;base64,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",tag:"events"},null)}T=a,O.console.info("Новые события: "+a+", вкладка активна: "+t)}else a<T&&(T=a,O.console.info("Скидываем счётчик до: "+a))}catch(e){O.console.error("Ошибка (EVENTS): "+e.name+":"+e.message+"\n"+e.stack)}},friendsOnline:function(e){var l=O.qs("#friends_cnt"),r=O.qs("#SP_PLUS_FRIENDSSB"),t=0;if(l&&!isNaN(l.innerHTML)&&(t=parseInt(l.innerHTML,10)),l)try{if(A.friendsListSH?r&&(l.parentNode.title||(l.parentNode.title="Скрыть список"),l.parentNode.hasAttribute("sp-click-el")||(l.parentNode.onclick=function(e){return"none"!=r.style.display?(r.style.display="none",e.target.parentNode.title="Показать список"):(r.style.display="",e.target.parentNode.title="Скрыть список"),!1},l.parentNode.setAttribute("sp-click-el","1"))):(l.parentNode.title="",l.parentNode.removeAttribute("sp-click-el"),l.parentNode.onclick=null,r&&"none"==r.style.display&&(r.style.display="")),e)if(0<t){if(p++,t!=o||0<t&&!r||700<=p){700<=p&&(p=0,O.console.info("[S+] Принудительно обновляем друзей!")),o=t;var a=l.parentNode.parentNode.parentNode;r=r||O.ce("div",{id:"SP_PLUS_FRIENDSSB",class:"list-link__wrap"}),O.jajax(E+"//"+N+"/friends/?S=3",function(e){try{var i=O.extend({tabbed_panel:{tabs:[null,{content:{list:null}}]}},JSON.parse(e)).tabbed_panel.tabs[1].content.list;i?O.jajax(E+"//"+N+"/friends/?P=2&S=3",function(e){var t=O.find(document.getElementsByTagName("span"),{className:"s_i s_i_exit"}),a=O.extend({tabbed_panel:{tabs:[null,{content:{list:{avatar:[null,{previewURL:null,name:null}],online_label:[null,{online_status:null,on_img:null}]}}}]}},JSON.parse(e)).tabbed_panel.tabs[1].content.list;a=a?O.extend(i,a):i,r.innerHTML="";var s=A.friendsOnMax>a.length?a.length:A.friendsOnMax;o!=a.length&&m<3?(m++,setTimeout(function(){o=a.length,O.console.info("[S+] Количество друзей не точное, пробуем еще раз ("+m+" из 3)")},1e3)):o==a.length&&(m=0);for(var n=0;n<s;n++)r.appendChild(O.ce("a",{href:E+"//"+N+"/mysite/index/"+a[n].name+"/",class:"li",html:(t?'<span class="comm_ava m for_avatar"><img src="'+a[n].avatar.previewURL+'" class="preview s21_20"></span>':"")+'<span class="online-status m"><img class="p14 online_status_ico" src="'+E+"//spac.me/i/"+a[n].online_status.on_img+'" alt="(ON)"></span><span class="block-item__title m break-word">'+a[n].name+"</span>"}));l.parentNode.removeAttribute("sp-click-el"),O.console.info("[S+] Обновили список друзей!")}):O.remove(r)}catch(e){O.console.error("Ошибка (FRIENDS-ONLINE-JSON): "+e.name+":"+e.message+"\n"+e.stack)}}),a.appendChild(r)}}else 0==t&&r&&O.remove(r);else r&&(O.remove(r),o=0,O.console.info("[S+] Убрали панель друзей!")),l.parentNode.onclick=null,l.parentNode.removeAttribute("sp-click-el"),p=0}catch(e){O.console.error("Ошибка (FRIENDS-ONLINE): "+e.name+":"+e.message+"\n"+e.stack)}},onlineWidget:function(){var e=document.location.pathname.toString(),t=O.getPath("target"),a="/anketa/index/"+t+"/";if(e==a)try{var i=O.getClassName("div.info-item__title",1);t&&i&&s!=t&&(s=t,O.jajax(E+"//"+N+"/anketa/index/"+t+"/",function(e){if(e)try{var t=O.extend({user_widget:{online_time:null}},JSON.parse(e));if(t.user_widget.online_time){var a=O.time2str(t.user_widget.online_time);for(var s in i)if("Время онлайн:"==i[s].innerHTML){var n=i[s].nextElementSibling||i[s].nextSibling;3==n.nodeType?n.data=" "+a:n.innerHTML=a,O.console.info("[S+] Время онлайн: "+a)}}}catch(e){O.console.error("Ошибка (JSON-ONLINE): "+e.name+":"+e.message+"\n"+e.stack)}}))}catch(e){O.console.error("Ошибка (ONLINE-WIDGET): "+e.name+":"+e.message+"\n"+e.stack)}else e!=a&&(s=null)},favoriteAdd:function(){var e=document.location.href,t=O.getPath("method"),a=O.getPath("index");if(e!=E+"//"+N+"/bookmarks/add/?irb526786=1"||c||(c=e,O.setLocation(E+"//"+N+"/bookmarks/?irb526786=1")),("mysite"==t||"anketa"==t&&"edit"!=a||"activity"==t)&&i!=e){var l=O.qs("#SP_PLUS_INFAVORITE");i=e;try{var r=O.getPath("target");r=r||(O.getQuery("user")||O.service(0));var o=O.getClassName("td.table__cell table__cell_last",1);r&&o&&o[0].innerHTML.indexOf("Вперёд")<0&&!l&&O.jajax(E+"//"+N+"/anketa/index/"+r,function(e){if(e)try{var t,a=O.extend({user_widget:{id:null}},JSON.parse(e));if(a.user_widget.id){t="A"==o[0].firstElementChild.nodeName?o[0].firstElementChild.className.split(" ")[0]:"stnd-link";var s=l||O.ce("td",{class:"table__cell",id:"SP_PLUS_INFAVORITE"});s.innerHTML='<a href="'+E+"//"+N+"/bookmarks/add/?object_id="+a.user_widget.id+'&object_type=11" class="'+t+'" title="Добавить в закладки"><span class="sp sp-fav"></span> B закладки</a>',O.isFav(a.user_widget.id,s,r,'<span class="sp sp-fav-on"></span><span style="color: #61a961;"> В закладках</span>'),l||O.inBefore(s,o[0]);var n=o[0].parentNode.childNodes;for(var i in n)"TD"==n[i].nodeName&&(n[i].width="25%")}}catch(e){O.console.error("Ошибка (JSON-FAVORITE): "+e.name+":"+e.message+"\n"+e.stack)}})}catch(e){O.console.error("Ошибка (FAVORITE): "+e.name+":"+e.message+"\n"+e.stack)}}else"mysite"!=t&&"anketa"!=t&&"activity"!=t&&(i=null)},rotateMedia:function(){var a=O.qs("#gallery-container"),s=O.qs("#galleryVideo"),e=O.qs("#SP_IMAGE_ROTATE");try{if(null!=a&&null==e){var t=O.qs("#g_dloadlink"),n=O.ce("a",{class:"gallery__tools_button",id:"SP_IMAGE_ROTATE",title:"Повернуть",html:"<span class='ico_gallery ico_gallery_reload m'></span>",onclick:function(){var e=O.getCookie("beta");if(null!=O.find(a.getElementsByTagName("img"),{src:E+"//"+e==1?"beta.spac.me":"spac.me/i/transparent.gif"})){var t=O.find(s.getElementsByTagName("span"),{className:"jwvideo"});t?(r=(r+90)%360,t[0].className="jwvideo rotate"+r):(l=(l+90)%360,a.className="accel-3d rotate"+l)}else l=(l+90)%360,a.className="accel-3d rotate"+l;return!1}});t.after(n)}}catch(e){O.console.error("Ошибка (ROTATE-MEDIA): "+e.name+":"+e.message+"\n"+e.stack)}},videoPlayback:function(){var e=O.qs("#main_wrap"),t=O.qs("#SP_PLAYBACK_VIDEO");try{if(e)var a=O.find(e.getElementsByTagName("span"),{className:"jwcontrols"});if(null!=a&&null==t){var s=O.find(e.getElementsByTagName("span"),{className:"jwtext jwduration jwhidden"}),n=O.ce("span",{class:"jwtext jwduration jwhidden",id:"SP_PLAYBACK_VIDEO",html:"x"+g,onclick:function(){return 0==(g=(g+.25)%2.25)&&(g=.5),n.innerHTML="x"+g,document.querySelector("video").playbackRate=g,!1}});s[0].after(n)}}catch(e){O.console.error("Ошибка (VIDEO-PLAYBACK): "+e.name+":"+e.message+"\n"+e.stack)}},isFav:function(e,s,n,i){O.jajax(E+"//"+N+"/bookmarks/add/?object_id="+e+"&object_type=11",function(e){if(e)try{var t=O.extend({delete_link:{delete_URL:null}},JSON.parse(e));if(t.delete_link.delete_URL){var a=t.delete_link.delete_URL.replace(/&amp;/g,"&");s.firstElementChild.href=a,s.firstElementChild.title="Удалить из закладок",s.firstElementChild.innerHTML=i,s.firstElementChild.onclick=function(){return O.confirmm("Вы действительно хотите удалить пользователя <b>"+n+"</b> из закладок?",0,function(){O.jajax(a,function(){document.location.reload()})}),!1}}}catch(e){O.console.error("Ошибка (JSON-ISFAVORITE): "+e.name+":"+e.message+"\n"+e.stack)}})},bannedHTML:function(e,t,a){return t?'<div class="widgets-group links-group"><a href="'+E+"//"+N+"/gifts/user_list/?user="+e+'" class="list-link list-link_arrow list-link_first"><span class="ico ico_gifts_blue"></span> Подарки<span class="ico ico_arr"></span></a>'+(a?"":'<a href="'+E+"//"+N+"/guestbook/?name="+e+'" class="list-link list-link_arrow list-link_first"><span class="ico ico_gb"></span> Гостевая<span class="ico ico_arr"></span></a><a href="'+E+"//"+N+"/diary/?name="+e+'" class="list-link list-link_arrow"><span class="ico ico_blog"></span> Личный блог<span class="ico ico_arr"></span></a>')+'<a href="'+E+"//"+N+"/forums/search_user/?Comm=0&Ext=1&Link_id=363467&query="+e+'" class="list-link list-link_arrow"><span class="ico ico_forum"></span> Темы и комментарии <span class="ico ico_arr"></span></a>'+(a?"":'<div class="sep-item"></div><a href="'+E+"//"+N+"/pictures/?P=1&amp;name="+e+'" class="list-link list-link_arrow"><span class="ico ico_photo"></span> Фотографии<span class="ico ico_arr"></span></a><a href="'+E+"//"+N+"/music/?P=1&amp;name="+e+'" class="list-link list-link_arrow"><span class="ico ico_music"></span> Музыка<span class="ico ico_arr"></span></a><a href="'+E+"//"+N+"/video/?P=1&amp;name="+e+'" class="list-link list-link_arrow"><span class="ico ico_video"></span> Видео<span class="ico ico_arr"></span></a><a href="'+E+"//"+N+"/files/?P=1&amp;name="+e+'" class="list-link list-link_arrow"><span class="ico ico_file"></span> Файлы<span class="ico ico_arr"></span></a>')+'<div class="sep-item"></div><a href="'+E+"//"+N+"/comm/?List=1&user="+e+'" class="list-link list-link_arrow"><span class="ico ico_comm"></span> Сообщества<span class="ico ico_arr"></span></a><a href="'+E+"//"+N+"/friends/?name="+e+'&amp;p=1" class="list-link list-link_arrow"><span class="ico ico_friends"></span> Друзья<span class="ico ico_arr"></span></a><a href="'+E+"//"+N+"/lenta/readers/?user="+e+'" class="list-link list-link_arrow"><span class="ico ico_readers"></span> Читатели<span class="ico ico_arr"></span></a></div>':'<div class="no_underline_block start_page_padd light_border_bottom" style="padding-top:1px;"><div><a href="'+E+"//"+N+"/gifts/user_list/?user="+e+'"><img src="'+E+'//spac.me/i/sendgift.gif" alt="" class="m p16"> <span class="m">Подарки</span></a></div>'+(a?"":'<div> <a href="'+E+"//"+N+"/guestbook/?name="+e+'&amp;p=0"><img src="'+E+'//spac.me/i/guestbook.gif" alt="" class="m p16"> <span class="m">Гостевая</span></a></div><div> <a href="'+E+"//"+N+"/diary/?name="+e+'"><img src="'+E+'//spac.me/i/diary.gif" alt="" class="m p16"> <span class="m">Блог</span></a></div>')+'</div><div class="no_underline_block start_page_padd light_blue light_border_bottom">'+(a?"":'<div> <a href="'+E+"//"+N+"/pictures/?P=1&amp;name="+e+'"><img src="'+E+'//spac.me/i/PhotoIcon.gif" alt="" class="m p16"> <span class="m">Фото</span></a></div><div> <a href="'+E+"//"+N+"/music/?P=1&amp;name="+e+'"><img src="'+E+'//spac.me/i/file_mp3.gif" alt="" class="m p16"> <span class="m">Музыка</span></a></div><div> <a href="'+E+"//"+N+"/video/?P=1&amp;name="+e+'"><img src="'+E+'//spac.me/i/icon_video.gif" alt="" class="m p16"> <span class="m">Видео</span></a></div><div> <a href="'+E+"//"+N+"/files/?P=1&amp;name="+e+'"><img src="'+E+'//spac.me/i/film.gif" alt="" class="m p16"> <span class="m">Файлы</span></a></div>')+'<div> <a href="'+E+"//"+N+"/forums/search_user/?Comm=0&Ext=1&word="+e+'"><img src="'+E+'//spac.me/i/Forum.gif" alt="" class="m p16"> <span class="m">Темы и комментарии</span></a> </div></div><div class="no_underline_block start_page_padd light_border_bottom"><div> <a href="'+E+"//"+N+"/friends/?name="+e+'"><img src="'+E+'//spac.me/i/friends.gif" alt="" class="m p16"> <span class="m">Друзья</span></a></div><div> <a href="'+E+"//"+N+"/comm/?List=1&user="+e+'"> <img src="'+E+'//spac.me/i/soo.gif" alt="" class="m p16"> <span class="m">Сообщества</span></a></div><div> <a href="'+E+"//"+N+"/lenta/readers/?user="+e+'"><img src="'+E+'//spac.me/i/icon_readers.gif" alt="" class="m p16"> <span class="m">Читатели</span></a></div></div>'},bannedTools:function(){var e=document.location.href.replace(/\#.*$/i,""),t=document.location.pathname.toString(),l=O.getPath("target"),a="/mysite/index/"+l+"/",r=!0,o=O.qs("#SP_PLUS_BNDBLOCK");if(t==a&&d!=e)try{l=l||(O.getPath("target")||O.service(0)),d=e,o&&O.remove(o),l&&O.jajax(E+"//"+N+"/mysite/index/"+l+"/",function(e){try{if(e){var t=O.qs("#siteContent");t||(t=O.getClassName("div.main",null))&&(t=t[0],r=!1);var a=O.extend({owner_id:null,owner_widget:{ban_info:{deleted:null,frozen:null,blocked:null}}},JSON.parse(e));if(a.owner_widget.ban_info&&a.owner_id&&t){var s=!1,n=a.owner_widget.ban_info.in_blacklist_result;if(a.owner_widget.ban_info.deleted)O.console.info("[S+] Аккаунт удален!");else if(n)switch(n){case"1":O.console.info("[S+] Аккаунт у вас в черном списке!");break;case"2":O.console.info("[S+] Вы в черном списке!")}else a.owner_widget.ban_info.frozen?O.console.info("[S+] Аккаунт покинут!"):a.owner_widget.ban_info.blocked&&(O.console.info("[S+] Аккаунт забанен!"),s=!0);var i=o||O.ce("div",{id:"SP_PLUS_BNDBLOCK"});i.innerHTML=O.bannedHTML(l,r,s),o||t.appendChild(i)}}}catch(e){O.console.error("Ошибка (JSON-BLOCKED): "+e.name+":"+e.message+"\n"+e.stack)}})}catch(e){O.console.error("Ошибка (BLOCKED): "+e.name+":"+e.message+"\n"+e.stack)}else t!=a&&(o&&O.remove(o),d=null)},extend:function(e,t){if(t)for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e},service:function(e){try{var t=document.getElementsByTagName("script").item(0);if(e){if(/REVISION\s?=\s?'(.*?)'/i.test(t.innerHTML)){var a=O.trim(/REVISION\s?=\s?'(.*?)'/i.exec(t.innerHTML)[1]);return""==a?null:a}return null}if(/name:'(.*?)'/i.test(t.innerHTML)){var s=O.trim(/name:'(.*?)'/i.exec(t.innerHTML)[1]);return""==s?null:s}return null}catch(e){return null}},getCK:function(e){var t=O.getCookie("sid");return e?t:t.substr(-4)},allCookie:function(){var e=new Object,t=document.cookie;if(t&&""!=O.trim(t))for(var a=t.split(";"),s=0;s<a.length;s++){var n=O.trim(a[s]);if(""!=n){var i=n.split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}}return e},getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},delCookie:function(e){O.setCookie(e,null,{expires:-1})},setCookie:function(e,t,a){!(a=O.extend({path:"/",expires:365,secure:!1,domain:"."+N},a)).expires||a.expires instanceof Date||(a.expires=new Date(+new Date+864e5*a.expires));var s=encodeURIComponent(e)+"="+encodeURIComponent(t);a.expires&&(s+="; expires="+a.expires.toUTCString()),a.domain&&(s+="; domain="+a.domain),a.path&&(s+="; path="+a.path),a.secure&&(s+="; secure"),document.cookie=s},find:function(e,t){for(var a=new Array,s=0;s<e.length;s++)for(var n in t)0<=e[s][n].indexOf(t[n])&&a.push(e[s]);return a[0]?a:null},readersDelete:function(){if("/lenta/readers/"==document.location.pathname.toString()&&!O.qs("#SP_PLUS_BOTTOM_DIVB"))try{var e=O.find(document.links,{href:E+"//"+N+"/lenta/reader_delete/?"});if(e&&!O.qs("#SP_PLUS_BOTTOM_DIVB")){var i=O.getCK(0),l=new Array;for(var t in e){e[t].style.textAlign="center";var a=O.ce("label",{class:"stnd-link icon-link",style:"right: 50px; top: -42px; padding-left: 8px; padding-right: 8px;"}),s=O.ce("input",{type:"checkbox",id:"SP_DR_"+/(\?|&)user=([A-Za-z0-9\_]+)/i.exec(e[t].href)[2],class:"sp-cbfr sp-checkbox-square"}),n=O.ce("label",{style:"margin-left: 0px;",attr:{for:"SP_DR_"+/(\?|&)user=([A-Za-z0-9\_]+)/i.exec(e[t].href)[2]}});a.appendChild(s),a.appendChild(n),O.insertAfter(a,e[t]),l.push(s)}var r=e[e.length-1].parentNode;if(r=r&&r.parentNode){var o=O.ce("div",{class:"user__tools_last",id:"SP_PLUS_BOTTOM_DIVB"}),c=O.ce("button",{class:"user__tools-link table__cell",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">Выбрать все</span>',onclick:function(e){for(var t="SPAN"==e.target.nodeName?e.target.parentNode:e.target,a=0;a<l.length;a++)0<=t.innerHTML.indexOf("Выбрать все")?l[a].checked=!0:l[a].checked=!1;return t.innerHTML='<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">'+(0<=t.innerHTML.indexOf("Выбрать все")?"Снять отметки":"Выбрать все")+"</span>",!1}}),d=O.ce("button",{class:"user__tools-link table__cell sp_btn_line",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="ico ico_delete"></span><span style="color: #F86934;">Удалить выбранных</span>',onclick:function(){var a=0,s=new Array;c.innerHTML='<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">Выбрать все</span>';for(var e=0;e<l.length;e++)if(1==l[e].checked){var t=/^SP_DR_([A-Za-z0-9\_]+)$/i.exec(l[e].id)[1];s.push(t),l[e].checked=!1,a++}if(0<a){var n=O.declOfNum(a,["я","я","ей"]);O.confirmm("Вы действительно хотите удалить "+a+" читател"+n+"?",0,function(){var t=setInterval(function(){O.alert("Процесс...<div class='pad_t_a'></div><small>Удаляем читателей <span class='ico ico_spinner'></span></small>",0,null);var e=s[--a];O.ajax(E+"//"+N+"/lenta/reader_delete/?user="+e,"POST","&CK="+i+"&cfms=Удалить","GET",function(){O.console.info("[S+] Удалили читателей: "+e)},2),a<0&&(s=null,clearInterval(t),document.location.reload())},500)})}else O.alert("Ошибка!<div class='pad_t_a'></div><small>Не выбрано ни одного читателя.</small>",1,null);return!1}});o.appendChild(d),o.appendChild(c),O.insertAfter(o,r)}else{for(t=0;t<l.length;t++)l[t].style.display="none";var p=O.ce("div",{style:"display: none;",id:"SP_PLUS_BOTTOM_DIVB"});document.body.appendChild(p)}}}catch(e){O.console.error("Ошибка (READERS-DELETE): "+e.name+":"+e.message+"\n"+e.stack)}},blogsDelete:function(){var e=document.location.pathname.toString().split("/");if("diary"==e[1]&&null==e[2]||"diary"==e[1]&&"view"==e[2]&&!O.qs("#SP_PLUS_BOTTOM_DIVB"))try{var t=O.find(document.links,{href:E+"//"+N+"/diary/editaccess/?Link_id="});if(t&&!O.qs("#SP_PLUS_BOTTOM_DIVB")){for(var i=O.getCK(0),l=new Array,a=0;a<t.length;a++)if(t[a].className){t[a].style.textDecoration="none";var s=O.ce("input",{type:"checkbox",id:"SP_DB_"+/\&id=([0-9]+)/i.exec(t[a].href)[1],class:"sp-cbfb sp-checkbox-square"}),n=O.ce("label",{style:"margin: 1px",attr:{for:"SP_DB_"+/\&id=([0-9]+)/i.exec(t[a].href)[1]}});O.insertAfter(s,t[a]),O.insertAfter(n,s),l.push(s)}var r=l[l.length-1].parentNode;if(r=(r=(r=r&&r.parentNode)&&r.parentNode)&&r.parentNode.parentNode){var o=O.ce("div",{class:"widgets-group user__tools_last",id:"SP_PLUS_BOTTOM_DIVB"}),c=O.ce("button",{class:"user__tools-link table__cell",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">Выбрать все</span>',onclick:function(e){for(var t="SPAN"==e.target.nodeName?e.target.parentNode:e.target,a=0;a<l.length;a++)0<=t.innerHTML.indexOf("Выбрать все")?l[a].checked=!0:l[a].checked=!1;return t.innerHTML='<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">'+(0<=t.innerHTML.indexOf("Выбрать все")?"Снять отметки":"Выбрать все")+"</span>",!1}}),d=O.ce("button",{class:"user__tools-link table__cell sp_btn_line",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="ico ico_delete"></span><span style="color: #F86934;">Удалить выбранные</span>',onclick:function(){var a=0,s=new Array;c.innerHTML='<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">Выбрать все</span>';for(var e=0;e<l.length;e++)if(1==l[e].checked){var t=/^SP_DB_([0-9]+)$/i.exec(l[e].id)[1];s.push(t),l[e].checked=!1,a++}if(0<a){var n=O.declOfNum(a,["","а","ов"]);O.confirmm("Вы уверены что хотите удалить "+a+" блог"+n+"?",0,function(){var t=setInterval(function(){O.alert("Процесс...<div class='pad_t_a'></div><small>Удаляем блоги <span class='ico ico_spinner'></span></small>",0,null);var e=s[--a];O.ajax(E+"//"+N+"/diary/delete/?CK="+i+"&id="+e+"&Sure=1","GET",null,null,2),a<0&&(clearInterval(t),document.location.reload())},500)})}else O.alert("Внимание!<div class='pad_t_a'></div><small>Не выбрано ни одного блога!</small>",1,null);return!1}});o.appendChild(d),o.appendChild(c),O.insertAfter(o,r)}else{for(a=0;a<l.length;a++)l[a].style.display="none";var p=O.ce("div",{style:"display: none;",id:"SP_PLUS_BOTTOM_DIVB"});document.body.appendChild(p)}}}catch(e){O.console.error("Ошибка (BLOGS-DELETE): "+e.name+":"+e.message+"\n"+e.stack)}},confirmm:function(e,t,a){var s=O.ce("button",{html:"Да",href:"#",class:"btn btn_red btn_input"}),n=O.ce("a",{html:"Отмена",href:"#",class:"btn btn_white btn_input right sticker-close_btn"}),i=O.ce("small",{class:"pad_t_a grey",html:"Это действие нельзя будет отменить."}),l=O.ce("div",{class:"content-item3 wbg oh",html:e+"<div class='pad_t_a'></div>"}),r=O.ce("div",{class:"pad_t_a"});s.onclick=function(){var e=O.qs("#SP_PLUS_CONFIRM");return!e||(a(),O.remove(e),!1)},n.onclick=function(){var e=O.qs("#SP_PLUS_CONFIRM");return!e||(O.remove(e),!1)};var o=O.qs("#SP_PLUS_CONFIRM");o||(o=O.ce("div",{class:"sticker",style:"-webkit-animation: create 0.3s; animation: create 0.3s;",id:"SP_PLUS_CONFIRM"}),t||l.appendChild(i),l.appendChild(r),l.appendChild(s),l.appendChild(n),o.appendChild(l),document.body.appendChild(o))},alert:function(e,t,a){var s=O.ce("div",{class:"sticker w400",style:"-webkit-animation: create 0.3s; animation: create 0.3s;"}),n=O.qs("#SP_PLUS_ALERT");n||(n=O.ce("div",{class:"content-item3 wbg oh",id:"SP_PLUS_ALERT",html:(t?'<span class="sp sp-remove-grey pointer right notif_close close_h" onclick="document.body.removeChild(this.parentNode.parentNode);" title="Закрыть"></span>':"")+e}),s.appendChild(n),document.body.appendChild(s)),a||setTimeout(function(){O.qs("#SP_PLUS_ALERT")&&O.qs("#SP_PLUS_ALERT").parentNode.parentNode.removeChild(s)},4e3)},commentsDelete:function(){var e=O.getClassName("span.comment_date",null),t=O.qs("#SP_PLUS_BOTTOM_DIV");try{if(e){if(!t||e.length!=_){_=e.length;var a=null,s=O.qs("div.js-comments-pgn"),l=O.find(document.getElementsByTagName("input"),{name:"del_comment_"});if(l){for(var n=O.find(l[0].parentNode.parentNode.parentNode.getElementsByTagName("a"),{innerHTML:"Удалить"}),i=0;i<l.length;i++)if(!l[i].id||!/^DC_\d+$/i.test(l[i].id)){var r=O.ce("label",{attr:{for:"DC_"+l[i].value}});l[i].id="DC_"+l[i].value,l[i].className="sp-checkbox-square",O.insertAfter(r,l[i])}}else for(var o=0;o<e.length;o++){if((a=O.find(e[o].parentNode.parentNode.parentNode.parentNode.getElementsByTagName("a"),{innerHTML:"Удалить"}))&&0==e[o].getElementsByTagName("input").length){var c=O.ce("input",{type:"checkbox",class:"sp-cbfc sp-checkbox-square",id:"DC_"+e[o].parentNode.parentNode.parentNode.parentNode.parentNode.id}),d=O.ce("label",{attr:{for:"DC_"+e[o].parentNode.parentNode.parentNode.parentNode.parentNode.id}});e[o].appendChild(c),e[o].appendChild(d)}o!=e.length-1||s||(s=e[o].parentNode.parentNode.parentNode.parentNode)}if((l&&n||a)&&!t){var p=document.getElementsByTagName("input"),u=O.ce("div",{class:"widgets-group user__tools_last",id:"SP_PLUS_BOTTOM_DIV"}),m=O.ce("button",{class:"user__tools-link table__cell",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">Выбрать все</span>',onclick:function(e){for(var t="SPAN"==e.target.nodeName?e.target.parentNode:e.target,a=0;a<p.length;a++)"checkbox"==p[a].type&&/DC_([0-9]+)/gi.test(p[a].id)&&"none"!=p[a].parentNode.parentNode.parentNode.style.display&&(0<=t.innerHTML.indexOf("Выбрать все")?p[a].checked=!0:p[a].checked=!1);return t.innerHTML='<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">'+(0<=t.innerHTML.indexOf("Выбрать все")?"Снять отметки":"Выбрать все")+"</span>",!1}}),g=O.ce("button",{class:"user__tools-link table__cell sp_btn_line",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="ico ico_delete"></span><span style="color: #F86934;">Удалить выбранные</span>',onclick:function(){for(var a=0,s=new Array,n=new Array,e=0;e<p.length;e++)if("checkbox"==p[e].type&&/DC_([0-9]+)/gi.test(p[e].id)&&1==p[e].checked){if(l)var t=O.find(p[e].parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("a"),{innerHTML:"Удалить"});else t=O.find(p[e].parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("a"),{innerHTML:"Удалить"});s.push(t[0]),n.push(p[e]),a++}if(0<a){var i=O.declOfNum(a,["й","я","ев"]);O.confirmm("Вы действительно хотите удалить "+a+" комментари"+i+"?",0,function(){var t=setInterval(function(){if(O.alert("Процесс...<div class='pad_t_a'></div><small>Удаляем комментарии <span class='ico ico_spinner'></span></small>",0,null),s[--a].href)O.ajax(s[a].href,"GET",null,null,2);else{var e=document.createEvent("MouseEvent");e.initEvent("click",!0,!0),s[a].dispatchEvent(e)}n[a].checked=!1,n[a].className+=" sp_plus_ch_cd",a<1&&(clearInterval(t),document.location.reload())},500)})}else O.alert("Ошибка!<div class='pad_t_a'></div><small>Не выбрано ни одного комментария.</small>",1,null);return!1}});u.appendChild(g),u.appendChild(m),s?O.insertAfter(u,s):O.qs("#page-down")?O.inBefore(u,O.qs("#page-down")):O.console.error("[S+] Не смогли найти ориентир для вставки!")}}}else _=0}catch(e){O.console.error("Ошибка (COMMENTS-DELETE): "+e.name+":"+e.message+"\n"+e.stack)}},playerDown:function(){var t=O.qs("#SP_MUSIC_DOWN");try{var e=0,a=sessionStorage.getItem("music:track"),s=sessionStorage.getItem("music:playlist"),n=O.qs("#gp_main_player");if(n&&a&&s){var i=JSON.parse(a);e=parseInt(i.id,10);var l=JSON.parse(s).playlist.playlist[e].src,r=O.find(n.getElementsByTagName("td"),{className:"ico_td"});if(r&&!t){u=e;var o=O.ce("td",{id:"SP_MUSIC_DOWN",class:"ico_td",innerHTML:'<a href="'+l+'" target="_blank" class="tdn"></span><span class="ico ico_download2" title="Скачать"></span></a>'});O.insertAfter(o,r[0])}else t&&u!=e&&(u=e,O.console.info("[S+] Обновили трек!"),t.innerHTML='<a href="'+l+'" target="_blank" class="tdn"></span><span class="ico ico_download2" title="Скачать"></span></a>')}}catch(e){t&&O.remove(t),O.console.error("Ошибка (PLAYER-DOWN): "+e.name+":"+e.message+"\n"+e.stack)}},coinsAccept:function(){var e=O.find(document.links,{href:E+"//"+N+"/services/gift_get/?Link_id="});if(e)try{O.ajax(e[0].href,"GET",null,null,2),O.remove(e[0].parentNode),O.console.info("[S+] Собрали монетку!")}catch(e){O.console.error("Ошибка (COINS): "+e.name+":"+e.message+"\n"+e.stack)}},karmaAccept:function(){var e=O.find(document.links,{href:E+"//"+N+"/mysite/rate_n_karma/karma/?Accept="});if(e)try{O.ajax(e[0].href,"GET",null,null,2),O.remove(e[0].parentNode),O.console.info("[S+] Собрали карму!")}catch(e){O.console.error("Ошибка (KARMA): "+e.name+":"+e.message+"\n"+e.stack)}},adsRemove:function(){var e=O.qs("#SP_PLUS_ADBLOCK"),t=O.find(document.links,{title:"Реклама"}),a=O.find(document.getElementsByTagName("img"),{src:"mobiads_plank_big.png"}),s=O.find(document.getElementsByTagName("a"),{href:"https://tracker.ma-static.ru/tracker.php"});try{if(a&&O.remove(a[0].parentNode.parentNode.parentNode.parentNode),s&&O.remove(s[0].parentNode),e)t&&O.remove(t[0].parentNode);else{var n=O.ce("script",{type:"text/javascript",id:"SP_PLUS_ADBLOCK",html:"var rawOpen = XMLHttpRequest.prototype.open; XMLHttpRequest.prototype.open = function() { if (!this._hooked) { this._hooked = true; setupHook(this); }; rawOpen.apply(this, arguments); }; function setupHook(xhr) { function getter() { delete xhr.responseText; var ret = xhr.responseText; var json = JSON.parse(ret); json.reklama = ''; json.rightbar_reklama = ''; json.rightbar_app = ''; json.sidebar_reklama = ''; ret = JSON.stringify(json); setup(); return ret; }; function setup() { Object.defineProperty(xhr, 'responseText', { get: getter, configurable: true }); } setup(); };"});document.getElementsByTagName("head")[0].appendChild(n)}}catch(e){O.console.error("Ошибка (ADBLOCK): "+e.name+":"+e.message+"\n"+e.stack)}},tinyFix:function(){try{var e=O.find(document.links,{className:"horiz-menu__link"});if(e){var t=e[2].cloneNode(!0),a=e[4].cloneNode(!0);e[2].replaceWith(a),e[4].replaceWith(t)}}catch(e){O.console.error("Ошибка (TINY-FIX): "+e.name+":"+e.message+"\n"+e.stack)}},apiDebugger:function(){var e=O.qs("#spaces_api_debugger");try{if(!e){var t=O.ce("script",{type:"text/javascript",html:'var Arr=[\'<div class="time-block" style="text-align: left; padding: 4px; background: #cddae7; border-bottom: 1px solid #a7b4c7;" id="spaces_api_debugger"><a href="#" id="api_debug-button" style="color: #0e3c87; margin-left: 5px"><span class="ico_cats" style="background-position: -55px -54px;margin: 0 4px -4px 0;"></span> Debugger</a><a href="https://spaces-dev.github.io/api" style="color: #0e3c87; float: right" target="_blank">API Methods</a><div id="api_debug-place" style="display: none; margin-top: 5px"></div></div>\',"append","parent","#navi","debugger"];$(Arr[3])[Arr[2]]()[Arr[1]](Arr[0]),require(Arr[4]);void(0);'});document.getElementsByTagName("head")[0].appendChild(t)}}catch(e){O.console.error("Ошибка (SPACES-API-DEBUGGER): "+e.name+":"+e.message+"\n"+e.stack)}},setStyle:function(){var e=O.service(1),t=O.qs("#SP_PLUS_INJSTYLE")||O.ce("style",{id:"SP_PLUS_INJSTYLE",type:"text/css"});if(!O.qs("#SP_PLUS_MENU")){var a=O.qs("#SP_PLUS_MENU")||O.ce("link",{rel:"stylesheet",type:"text/css",id:"SP_PLUS_MENU",href:"https://"+L+"/src/attaches/css/menu.css?r="+e});document.getElementsByTagName("head")[0].appendChild(a)}if(A.bodystyle&&(A.bodystyleSetting.url&&A.bodystyleSetting.urlchecked&&(t.innerHTML="body,#main_wrap{background-image:url("+A.bodystyleSetting.url+")}"),A.bodystyleSetting.color&&A.bodystyleSetting.colorchecked&&(t.innerHTML="body,#main_wrap{background-color:"+A.bodystyleSetting.color+"}")),A.msgAlert){var s=A.msgAlertSettings;if(s.alertPosition||s.animDelay){var n,i;switch(s.alertPosition){case 1:i="bottom: 0px; right: 0px; top:0px; left:0px; height: 1px; width: 1px;",n="margin-bottom: 10px;";break;case 2:i="top: 0px; right: 0px; height: 1px;",n="margin-bottom: 10px;";break;case 3:i="bottom: 0px; left: 0px; width: 1px;",n="margin-top: 10px;";break;default:i="bottom: 0px; right: 0px;",n="margin-top: 10px;"}t.innerHTML+=".mailBox{background:#fff; box-shadow: 0 0 5px rgba(93,109,157,.3); text-decoration:none !important; display:block; width:280px; height:auto; "+n+" -webkit-animation: create 0."+A.msgAlertSettings.animDelay+"s; animation: create 0."+A.msgAlertSettings.animDelay+"s} .mailContainer {z-index: 99999; position: fixed; "+i+" padding: 10px} .mailBox .data {display: inline-block; position: absolute;} .mailBox .avatar {width: 64px; padding-right: 5px; border-radius:2px; margin-bottom: -3px;} .text>img {display: inline-block;}.text>div.image_limit {width: 28px; display: inline-block;} .mailBox .name {line-height: 20px; font-weight: bold; width: 185px; overflow: hidden;} .mailBox .text {white-space: nowrap; text-overflow: ellipsis; overflow: hidden; color: #323232; width: 195px; font-size: small; height: 44px;} @-webkit-keyframes create {0% {opacity: 0;} 100% {opacity: 1;}} @-webkit-keyframes destroy {0% {opacity: 1;} 100% {opacity: 0;}}}"}}document.getElementsByTagName("head")[0].appendChild(t)},spacesBackup:function(e){window.scrollTo(0,0);var i=O.qs(e);if(i)try{var l;i.innerHTML="";var r=O.ce("div",{class:"content-bl"});if(!A.hideNotyf.configImport){var t=O.ce("span",{class:"sp sp-remove-grey pointer right notif_close close_h",style:"margin: 10px",title:"Понятно, больше не показывать.",onclick:function(){A.hideNotyf.configImport=!0;var e=JSON.stringify(A);O.setCookie("SP_PLUS_SET",e,null),O.remove(O.qs("#SP_CONFIG_JSON"))}}),a=O.ce("div",{class:"stnd-block-yellow",style:"padding: 15px;",html:'<span class="sp sp-alert"></span>Внимание!</br></br><div style="font-size: small;">Редактирование только для опытных пользователей, если что-то пошло не так, следует сделать полный сброс настроек.</div>'}),s=O.ce("div",{id:"SP_CONFIG_JSON"});s.appendChild(t),i.appendChild(s),s.appendChild(a)}var n=O.ce("div",{class:"t_center",id:"SP_JSON_PRELOADER",html:"<img src='https://beta.spac.me/i/preloader.gif'>"});i.appendChild(r),r.appendChild(n);var o=O.ce("div",{class:"text-input__wrap"}),c=O.ce("div",{id:"JSON_ERROR_BLOCK",class:"stnd-block-yellow",style:"padding: 15px;",html:'<span class="sp sp-alert"></span> Invalid JSON!<br /><br />'}),d=O.ce("div",{class:"cl"}),p=O.ce("div",{class:"widgets-group user__tools_last",id:"SP_PLUS_BOTTOM_DIVB"}),u=O.ce("button",{class:"user__tools-link table__cell sp_btn_line",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="sp sp-restore-g"></span><span style="color: #3ca93c;">Сбросить</span>',onclick:function(){return O.confirmm("Сбросить файл конфигурации?",0,function(){O.delCookie("SP_PLUS_SET"),document.location.reload()}),!1}}),m=O.ce("button",{class:"user__tools-link",style:"width: 50%; display: inline-block; box-sizing: border-box;",html:'<span class="sp sp-ok-blue"></span><span style="color: #57A3EA;">Сохранить</span>',onclick:function(){var e="value="+l.value;return O.ajax("https://crashmax.ru/api/getJSON","POST",e,function(e){if(e){var t=O.extend({result:{valid:0,jsoncopy:"",errors:{code:0,message:"",element:0}}},JSON.parse(e));if(1==t.result.valid){O.setCookie("SP_PLUS_SET",l.value,null),document.location.reload();var a=O.qs("#JSON_ERROR_BLOCK");a&&O.remove(a)}else{i.appendChild(c);for(var s=0;s<t.result.errors.length;s++){var n=O.ce("div",{style:"padding-left: 30px; font-size: small;",html:"<b>Error:</b> "+t.result.errors[s].message+" [Code: "+t.result.errors[s].code+", Sctructure: "+t.result.errors[s].element+"]<br />"});c.appendChild(n)}}}}),!1}}),g="value="+JSON.stringify(A);O.ajax("https://crashmax.ru/api/getJSON","POST",g,function(e){if(e){var t=O.extend({result:{valid:0,jsoncopy:"",errors:{code:0,message:"",element:0}}},JSON.parse(e));if(l=O.ce("textarea",{class:"text-input",id:"SP_BACKUP_JSON",cols:"17",rows:"53",html:t.result.jsoncopy}),1==t.result.valid){i.appendChild(r),r.appendChild(o),o.appendChild(d),d.appendChild(l);var a=O.qs("#SP_JSON_PRELOADER");O.remove(a)}else{i.appendChild(c);for(var s=0;s<t.result.errors.length;s++){var n=document.createElement("div");n.style="padding-left: 30px; font-size: small;",n.innerHTML="<b>Error:</b> "+t.result.errors[s].message+" [Code: "+t.result.errors[s].code+", Sctructure: "+t.result.errors[s].element+"]<br />",c.appendChild(n)}}i.appendChild(r),r.appendChild(o),o.appendChild(d),d.appendChild(l),p.appendChild(u),p.appendChild(m),O.inBefore(p,O.qs("#SP_PLUS_ABOUT"))}})}catch(e){O.console.error("Ошибка (BACKUP-SETTINGS): "+e.name+":"+e.message+"\n"+e.stack)}},spacesChangelog:function(e){window.scrollTo(0,0);var t=O.qs(e);if(t)try{t.innerHTML="";var a=O.ce("div",{class:"wbg error__item_wrapper",style:"padding: 5px 15px 5px 16px; display: block;"}),l=O.ce("div",{class:"pad_t_a"}),s=O.ce("div",{class:"js-input_error_wrap"}),n=O.ce("div",{class:"t_center",id:"SP_JSON_PRELOADER",html:"<img src='https://beta.spac.me/i/preloader.gif'>"});s.appendChild(l),a.appendChild(s),t.appendChild(a),a.appendChild(n),O.ajax("https://"+L+"/updater.json?r="+O.service(1),"GET",null,function(e){if(e){var t=O.extend({history:{build:0,date:"",changes:""}},JSON.parse(e)),a=O.qs("#SP_JSON_PRELOADER");O.remove(a);for(var s=0;s<t.history.length;s++){var n=O.ce("label",{class:"label sp_plus_line_c",html:"v"+O.rever(t.history[s].build)+'<div class="label__desc">'+t.history[s].date+"</div>"}),i=O.ce("div",{class:"grey",style:"font-size: small; margin-left: 3rem;",html:t.history[s].changes});l.appendChild(n),l.appendChild(i)}}})}catch(e){O.console.error("Ошибка (CHANGELOG-ALERT): "+e.name+":"+e.message+"\n"+e.stack)}},spacesUpdater:function(){O.ajax("https://"+L+"/updater.json?r="+O.service(1),"GET",null,function(e){if(e){var a=O.extend({history:{build:0,date:"",changes:""}},JSON.parse(e)),t=0;if(A.upVersion&&(t=parseInt(A.upVersion,10)),P=Math.max(t,P),a.history[0].build>P&&(O.alert("Доступна новая версия Spaces+ <sup>"+O.rever(a.history[0].build)+'</sup><div class="pad_t_a"></div><small class="grey">'+a.history[0].changes+'</small><div id="SP_UPDATER_BUTTONS" class="pad_t_a"><a class="btn btn_green btn_input" href="https://github.com/spaces-dev/'+L+"/raw/master/spaces-plus.user.js?r="+O.service(1)+'" onclick="document.body.removeChild(this.parentNode.parentNode.parentNode); return true"> Обновить</a></div>',1,1),O.qs("#SP_PLUS_ALERT"))){var s=O.ce("a",{href:"#",class:"btn btn_white btn_input right sticker-close_btn",html:"Больше не показывать",onclick:function(e){A.upVersion=parseInt(a.history[0].build);var t=JSON.stringify(A);return O.setCookie("SP_PLUS_SET",t,null),document.body.removeChild(e.target.parentNode.parentNode.parentNode),!1}});O.qs("#SP_UPDATER_BUTTONS").appendChild(s)}}},4)},msgAlertSettings:function(e){var t=O.ce("div",{id:"SP_PLUS_MSGALERTSETTINGS",style:"padding: 11px 15px;"}),a=O.ce("input",{type:"text",class:"text-input",size:4,attr:{maxlength:1},value:A.msgAlertSettings.maxAlert});a.onchange=a.oninput=function(e){if(/^[1-5]{1}$/i.test(e.target.value)){A.msgAlertSettings.maxAlert=parseInt(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),a.className="text-input"}else a.className="text-input sp-input-error"};var s=O.ce("input",{type:"text",class:"text-input",size:4,attr:{maxlength:1},value:A.msgAlertSettings.alertPosition});s.onchange=s.oninput=function(e){if(/^[1-4]{1}$/i.test(e.target.value)){A.msgAlertSettings.alertPosition=parseInt(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),s.className="text-input"}else s.className="text-input sp-input-error"};var n=O.ce("label",{html:'Расположение на экране:<div class="label__desc">от 1 до 4</div>',class:"label"}),i=O.ce("label",{html:'Максимум сообщений на экране:<div class="label__desc">от 1 до 5</div>',class:"label"}),l=O.ce("input",{type:"text",class:"text-input",size:4,attr:{maxlength:1},value:A.msgAlertSettings.alertDelay});l.onchange=l.oninput=function(e){if(/^[0-5]{1}$/i.test(e.target.value)){A.msgAlertSettings.alertDelay=parseInt(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),l.className="text-input"}else l.className="text-input sp-input-error"};var r=O.ce("label",{html:'Время отображения сообщения (0 - бесконечно):<div class="label__desc">от 0 до 5</div>',class:"label"}),o=O.ce("input",{type:"text",class:"text-input",size:4,attr:{maxlength:1},value:A.msgAlertSettings.animDelay});o.onchange=o.oninput=function(e){if(/^[1-9]{1}$/i.test(e.target.value)){A.msgAlertSettings.animDelay=parseInt(e.target.value);var t=JSON.stringify(A);O.setCookie("SP_PLUS_SET",t,null),O.setStyle(),o.className="text-input"}else o.className="text-input sp-input-error"};var c=O.ce("label",{html:'Время появления и исчезания сообщения:<div class="label__desc">от 1 до 9</div>',class:"label"});t.appendChild(i),t.appendChild(a),t.appendChild(n),t.appendChild(s),t.appendChild(c),t.appendChild(o),t.appendChild(r),t.appendChild(l),O.insertAfter(t,e.parentNode)},msgAlert:function(f){1==f.act&&(params="Contact="+f.data.contact.nid+"&MeSsages="+f.data.nid+"&Pag=0&_origin="+encodeURI(E+"//"+N)+"&method=getMessagesByIds",O.ajax(E+"//"+N+"/neoapi/mail","POST",params,function(u){if(-1!=window.location.href.indexOf(E+"//"+N+"/mail/message_list/?Contact="+f.data.contact.nid))return!1;var m,g;u=JSON.parse(u);var _=Object.keys(u.messages)[0];m=null!=f.data.contact.user?(null==u.messages[_].contact.avatar?O.jajax(E+"//"+N+"/mysite/index/"+f.data.contact.user+"/",function(e){e=JSON.parse(e),g=e.owner_widget.photo_widget.previewURL}):g=u.messages[_].contact.avatar.previewURL,f.data.contact.user):u.messages[_].subject?(g="https://"+L+"/src/attaches/ico/email.png",u.messages[_].contact.name):(g="https://"+L+"/src/attaches/ico/groups_chat.png",u.messages[_].contact.widget.siteLink.user_name+" ["+u.messages[_].contact.name+"]");var v=setInterval(function(){if(null!=g){clearInterval(v);var e,t=O.ce("div",{class:"mailContainer"});document.getElementsByClassName("mailContainer")[0]?t=document.getElementsByClassName("mailContainer")[0]:document.body.appendChild(t);var a=!1,s=1e3*A.msgAlertSettings.animDelay,n=1e3*A.msgAlertSettings.alertDelay,i=A.msgAlertSettings.maxAlert,l=O.ce("a",{class:"mailBox",href:"#",id:f.data.nid,onclick:function(){if(!a)return O.setLocation(E+"//"+N+"/mail/message_list/?Contact="+f.data.contact.nid),t.removeChild(l),!(a=!0)}}),r=O.ce("div",{class:"data"}),o=O.ce("div",{class:"name",html:m}),c=O.ce("div",{class:"text",html:u.messages[_].text}),d=O.ce("img",{class:"avatar",src:g}),p=O.ce("span",{class:"sp sp-remove-grey pointer right notif_close close_h",style:"margin: 5px",onclick:function(){a||(clearTimeout(e),t.removeChild(l),a=!0)}});document.querySelectorAll(".mailContainer a").length>i-1&&t.removeChild(t.firstChild),r.appendChild(o),r.appendChild(c),l.appendChild(p),l.appendChild(d),l.appendChild(r),t.appendChild(l),0!=n&&(e=setTimeout(function(){document.getElementById(l.id)&&(a=!0,l.style="animation: destroy "+s/1e3+"s;",setTimeout(function(){t.removeChild(l)},s))},n))}},500)},4,!0))},preloadModifer:function(){var t=!1,a=window;if("undefined"!=typeof unsafeWindow&&"firefox"==unsafeWindow.Device.browser&&"desktop"==unsafeWindow.Device.type&&(a=unsafeWindow,t=!0),A.msgAlert)var s=setInterval(function(){if("boolean"==typeof a.pushstream._keepConnected&&a.pushstream._keepConnected){clearInterval(s);var e=new Proxy(a.Spaces.PushStream.prototype._onmessage,{apply:function(e,t,a){O.msgAlert(a[0])}});t?exportFunction(e,a.Spaces.PushStream.prototype,{defineAs:"_onmessage"}):a.Spaces.PushStream.prototype._onmessage=e}},500)},spacesButton:function(){var e=O.qs("#SP_SETTINGS_BUTTON"),t=O.find(document.links,{href:E+"//"+N+"/services/?"}),a=O.find(document.getElementsByTagName("span"),{className:"s_i s_i_exit"});if(t&&!e){var s=O.ce("li",{class:"li",id:"SP_SETTINGS_BUTTON",html:'<a href="'+E+"//"+N+'/settings/?sp_plus_settings=1" title="Настройки Spaces+">'+(a?'<span class="sp sp-ico"></span>':"")+'<span class="m s_i_text"> Spaces+</span></a>'});t=t[0].parentNode,O.insertAfter(s,t),"BR"==t.nextElementSibling.nodeName&&O.insertAfter(O.ce("br",null),s)}},nonRedirect:function(){var e=O.find(document.links,{href:E+"//"+N+"/index/redirect/?"});try{if(e)for(var t=0;t<e.length;t++)e[t].setAttribute("href",O.getParams(e[t]).redirect)}catch(e){O.console.error("Ошибка (NON-REDIRECT): "+e.name+":"+e.message+"\n"+e.stack)}},freeStickers:function(){var e=O.qs("#SP_PLUS_STICKERS");try{if(!e){var t=O.ce("script",{type:"text/javascript",id:"SP_PLUS_STICKERS",html:'var open=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,o,t){var n=open.apply(this,arguments);return-1==o.indexOf("mail/sendMessage")&&-1==o.indexOf("diary/new")&&-1==o.indexOf("comments/add")||this.setRequestHeader("X-Proxy","spaces"),n};'});document.getElementsByTagName("head")[0].appendChild(t)}}catch(e){O.console.error("Ошибка (FREE-STICKERS): "+e.name+":"+e.message+"\n"+e.stack)}},spacesAPI:function(e,t,a){var s=new XMLHttpRequest;s.open("POST",E+"//"+N+"/api/"+e,!0),t?(s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(t)):s.send(null),s.onreadystatechange=function(){if(4!=s.readyState)return null;200==s.status&&a(s.status,s.response)}},userStatus:function(e){try{var t=O.ce("div",{html:"Для работы <b>Spaces+</b> необходима авторизация!"});if(3!=n.id&&4!=n.id||"01001"!=e){if(1!=n.id&&2!=n.id)return!0;var a=O.ce("div",{class:"oh busi",style:"border: 1px solid #ff9a95;background: #fdf3ef",html:"Используемая версия сайта не поддерживается для работы <b>Spaces+</b>"});return"01001"==e&&a.prepend(t),O.qs("#main_wrap").prepend(a),!1}var s=O.ce("div",{class:"oh nl system-message",style:"border: 1px solid #ff9a95;background: #fdf3ef"});s.prepend(t),O.qs("#top_info_block").prepend(s)}catch(e){O.console.error("Ошибка (USER-STATUS): "+e.name+":"+e.message+"\n"+e.stack)}},easyBeta:function(){var e=O.find(document.getElementsByTagName("div"),{className:"progress-item__label"}),t=O.find(document.getElementsByTagName("div"),{className:"progress-item__runner"});if(e&&t){var a=e[0].textContent.split("/"),s=Math.round(Number(a[0])/Number(a[1])*100);30<s&&(e[0].style="color: #f5f5f5"),t[0].style="width: "+s+"%"}},start:function(){if(A.hrightbar&&O.hiddenRightbar(),A.comments&&O.commentsDelete(),A.readersd&&O.readersDelete(),A.playback&&O.videoPlayback(),A.nredirect&&O.nonRedirect(),A.apidebug&&O.apiDebugger(),A.myEvents&&O.soundEvents(),A.favorite&&O.favoriteAdd(),A.sticker&&O.freeStickers(),A.blocked&&O.bannedTools(),A.online&&O.onlineWidget(),A.blogsd&&O.blogsDelete(),A.rotate&&O.rotateMedia(),A.rscroll&&O.scrollMove(),A.karma&&O.karmaAccept(),A.coins&&O.coinsAccept(),A.ads&&O.adsRemove(),A.friendsOn&&O.friendsOnline(1),A.playerdn)O.playerDown();else if(!A.playerdn&&0<=u){u=-1;var e=O.qs("#SP_MUSIC_DOWN");e&&O.remove(e)}O.spacesButton(),O.settings()},init:function(){A.fixes&&O.tinyFix(),O.spacesUpdater(),O.readSettings(),O.setStyle(),O.start();var e=setInterval(function(){null!=n&&(clearInterval(e),O.preloadModifer())},500);setInterval(function(){O.start()},200)}}).qs("#main_wrap")&&O.spacesAPI("session/check",null,function(e,t){t=JSON.parse(t),200==e&&O.userStatus(t.code)&&O.init()})}();